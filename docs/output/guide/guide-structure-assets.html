<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/90d046f2/css/bootstrap.css" rel="stylesheet">
<link href="./assets/c6368d94/solarized_light.css" rel="stylesheet">
<link href="./assets/9f5cdd92/style.css" rel="stylesheet">
<script src="./assets/a6e53573/jquery.js"></script>
<script src="./assets/90d046f2/js/bootstrap.js"></script>
<script src="./assets/218ce2e5/jssearch.js"></script>    <title>Assets - Kiến trúc ứng dụng (Application Structure) - The Definitive Guide to Yii 2.0</title>
</head>
<body>

<div class="wrap">
    <nav id="w12220" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w12220-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./guide-index.html">The Definitive Guide to Yii 2.0</a></div><div id="w12220-collapse" class="collapse navbar-collapse"><ul id="w12221" class="navbar-nav nav"><li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-12204" data-toggle="collapse" data-parent="#navigation">Giới thiệu <b class="caret"></b></a><div id="navigation-12204" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">Về Yii</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">Nâng cấp lên từ phiên bản 1.1</a></div>
<a class="list-group-item" href="#navigation-12205" data-toggle="collapse" data-parent="#navigation">Bắt đầu <b class="caret"></b></a><div id="navigation-12205" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-installation.html">Cài đặt Yii</a>
<a class="list-group-item" href="./guide-start-workflow.html">Thực hiện chạy ứng dụng</a>
<a class="list-group-item" href="./guide-start-hello.html">Viết lời chào đầu tiên</a>
<a class="list-group-item" href="./guide-start-forms.html">Làm việc với Forms</a>
<a class="list-group-item" href="./guide-start-databases.html">Làm việc với Databases</a>
<a class="list-group-item" href="./guide-start-gii.html">Sử dụng Gii để sinh code</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">Mức cao hơn</a></div>
<a class="list-group-item active" href="#navigation-12206" data-toggle="collapse" data-parent="#navigation">Kiến trúc ứng dụng (Application Structure) <b class="caret"></b></a><div id="navigation-12206" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./guide-structure-overview.html">Tổng quan về kiến trúc ứng dụng</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">Mục Scripts</a>
<a class="list-group-item" href="./guide-structure-applications.html">Ứng dụng (Applications)</a>
<a class="list-group-item" href="./guide-structure-application-components.html">Thành phần ứng dụng</a>
<a class="list-group-item" href="./guide-structure-controllers.html">Bộ điều khiển (Controllers)</a>
<a class="list-group-item" href="./guide-structure-models.html">Models</a>
<a class="list-group-item" href="./guide-structure-views.html">Views</a>
<a class="list-group-item" href="./guide-structure-modules.html">Modules</a>
<a class="list-group-item" href="./guide-structure-filters.html">Bộ lọc (Filters)</a>
<a class="list-group-item" href="./guide-structure-widgets.html">Widgets</a>
<a class="list-group-item active" href="./guide-structure-assets.html">Assets</a>
<a class="list-group-item" href="./guide-structure-extensions.html">Phần mở rộng (Extensions)</a></div>
<a class="list-group-item" href="#navigation-12207" data-toggle="collapse" data-parent="#navigation">Yêu cầu xử lý (Handling Requests) <b class="caret"></b></a><div id="navigation-12207" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">Tổng quan</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">Bootstrapping</a>
<a class="list-group-item" href="./guide-runtime-routing.html">Routing và URL Creation</a>
<a class="list-group-item" href="./guide-runtime-requests.html">Yêu cầu (Requests)</a>
<a class="list-group-item" href="./guide-runtime-responses.html">Responses</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Sessions và Cookies</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">Xử lý lỗi (Handling Error)</a>
<a class="list-group-item" href="./guide-runtime-logging.html">Logging</a></div>
<a class="list-group-item" href="#navigation-12208" data-toggle="collapse" data-parent="#navigation">Các khái niệm chính <b class="caret"></b></a><div id="navigation-12208" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-concept-components.html">Thành phần (Components)</a>
<a class="list-group-item" href="./guide-concept-properties.html">Thuộc tính (Properties)</a>
<a class="list-group-item" href="./guide-concept-events.html">Sự kiện (Events)</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">Hành vi (Behaviors)</a>
<a class="list-group-item" href="./guide-concept-configurations.html">Cấu hình (Configurations)</a>
<a class="list-group-item" href="./guide-concept-aliases.html">Bí danh (Aliases)</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">Lớp tự động nạp (Autoloading)</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">Service Locator</a>
<a class="list-group-item" href="./guide-concept-di-container.html">Dependency Injection Container</a></div>
<a class="list-group-item" href="#navigation-12209" data-toggle="collapse" data-parent="#navigation">Làm việc với Databases <b class="caret"></b></a><div id="navigation-12209" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-db-dao.html">Data Access Objects</a>
<a class="list-group-item" href="./guide-db-query-builder.html">Query Builder</a>
<a class="list-group-item" href="./guide-db-active-record.html">Active Record</a>
<a class="list-group-item" href="./guide-db-migrations.html">Migrations</a>
<a class="list-group-item" href="./guide-db-sphinx.html">Sphinx</a>
<a class="list-group-item" href="./guide-db-redis.html">Redis</a>
<a class="list-group-item" href="./guide-db-mongodb.html">MongoDB</a>
<a class="list-group-item" href="./guide-db-elasticsearch.html">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-12210" data-toggle="collapse" data-parent="#navigation">Nhận dữ liệu từ user <b class="caret"></b></a><div id="navigation-12210" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">Tạo mới Forms</a>
<a class="list-group-item" href="./guide-input-validation.html">Kiểm tra dữ liệu đầu vào (Validating Input)</a>
<a class="list-group-item" href="./guide-input-file-upload.html">File Upload</a>
<a class="list-group-item" href="./guide-input-tabular-input.html">Thu thập dữ liệu từ danh sách đầu vào (Đang phát triển)</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">Lấy dữ liệu cho nhiều Models (Chưa giải quyết)</a></div>
<a class="list-group-item" href="#navigation-12211" data-toggle="collapse" data-parent="#navigation">Hiển thị dữ liệu <b class="caret"></b></a><div id="navigation-12211" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatter.html">Định dạng dữ liệu (Data Formatting)</a>
<a class="list-group-item" href="./guide-output-pagination.html">Phân trang (Pagination)</a>
<a class="list-group-item" href="./guide-output-sorting.html">Sắp xếp (Sorting)</a>
<a class="list-group-item" href="./guide-output-data-providers.html">Cung cấp dữ liệu ra (Data Providers)</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">Dữ liệu Widgets</a>
<a class="list-group-item" href="./guide-output-client-scripts.html">làm việc với Client Scripts</a>
<a class="list-group-item" href="./guide-output-theming.html">Giao diện (Theming)</a></div>
<a class="list-group-item" href="#navigation-12212" data-toggle="collapse" data-parent="#navigation">Bảo mật (Security) <b class="caret"></b></a><div id="navigation-12212" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-authentication.html">Xác thực (Authentication)</a>
<a class="list-group-item" href="./guide-security-authorization.html">Quyền (Authorization)</a>
<a class="list-group-item" href="./guide-security-passwords.html">Các thao tác xử lý với Passwords (Đang phát triển)</a>
<a class="list-group-item" href="./guide-security-auth-clients.html">Auth Clients</a>
<a class="list-group-item" href="./guide-security-best-practices.html">Best Practices</a></div>
<a class="list-group-item" href="#navigation-12213" data-toggle="collapse" data-parent="#navigation">Bộ nhớ Cache <b class="caret"></b></a><div id="navigation-12213" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">Tổng quan</a>
<a class="list-group-item" href="./guide-caching-data.html">Cache dữ liệu</a>
<a class="list-group-item" href="./guide-caching-fragment.html">Fragment Caching</a>
<a class="list-group-item" href="./guide-caching-page.html">Page Caching</a>
<a class="list-group-item" href="./guide-caching-http.html">HTTP Caching</a></div>
<a class="list-group-item" href="#navigation-12214" data-toggle="collapse" data-parent="#navigation">RESTful Web Services <b class="caret"></b></a><div id="navigation-12214" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">Bắt đầu</a>
<a class="list-group-item" href="./guide-rest-resources.html">Tài nguyên (Resources)</a>
<a class="list-group-item" href="./guide-rest-controllers.html">Bộ điều khiển (Controllers)</a>
<a class="list-group-item" href="./guide-rest-routing.html">Routing</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">Định dạng thông điệp gửi đi (Response Formatting)</a>
<a class="list-group-item" href="./guide-rest-authentication.html">Xác thực (Authentication)</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">Rate Limiting</a>
<a class="list-group-item" href="./guide-rest-versioning.html">Phiên bản (Version)</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">Error Handling</a></div>
<a class="list-group-item" href="#navigation-12215" data-toggle="collapse" data-parent="#navigation">Công cụ phát triển (Development Tools) <b class="caret"></b></a><div id="navigation-12215" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tool-debugger.html">Thanh công cụ gỡ lỗi và sửa lỗi (Debug Toolbar và Debugger)</a>
<a class="list-group-item" href="./guide-tool-gii.html">Sử dụng Gii để tạo code</a>
<a class="list-group-item" href="./guide-tool-api-doc.html">Tạo tài liệu về API </a></div>
<a class="list-group-item" href="#navigation-12216" data-toggle="collapse" data-parent="#navigation">Testing <b class="caret"></b></a><div id="navigation-12216" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-test-overview.html">Tổng quan</a>
<a class="list-group-item" href="./guide-test-environment-setup.html">Thiết lập môi trường</a>
<a class="list-group-item" href="./guide-test-unit.html">Unit Tests</a>
<a class="list-group-item" href="./guide-test-functional.html">Kiểm tra chức năng (Functional Tests)</a>
<a class="list-group-item" href="./guide-test-acceptance.html">Acceptance Tests</a>
<a class="list-group-item" href="./guide-test-fixtures.html">Fixtures</a></div>
<a class="list-group-item" href="#navigation-12217" data-toggle="collapse" data-parent="#navigation">Chủ đề năng cao <b class="caret"></b></a><div id="navigation-12217" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tutorial-advanced-app.html">Advanced Application Template</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">Building Application from Scratch</a>
<a class="list-group-item" href="./guide-tutorial-console.html">Giao diện dòng lệnh (Console Commands)</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">Core Validators</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">Quốc tế hóa (Internationalization)</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">Thư (Mailing)</a>
<a class="list-group-item" href="./guide-tutorial-performance-tuning.html">Tối ưu hiệu năng ứng dụng (Performance Tuning)</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">Shared Hosting Environment</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">Template Engines</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">Working with Third-Party Code</a></div>
<a class="list-group-item" href="#navigation-12218" data-toggle="collapse" data-parent="#navigation">Widgets <b class="caret"></b></a><div id="navigation-12218" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-widget-bootstrap.html">Bootstrap Widgets</a>
<a class="list-group-item" href="./guide-widget-jui.html">jQuery UI Widgets</a></div>
<a class="list-group-item" href="#navigation-12219" data-toggle="collapse" data-parent="#navigation">Helpers <b class="caret"></b></a><div id="navigation-12219" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">Tổng quan</a>
<a class="list-group-item" href="./guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./guide-helper-html.html">Html</a>
<a class="list-group-item" href="./guide-helper-url.html">Url</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>アセット <span id="asetto"></span><a href="#asetto" class="hashlink">&para;</a></h1>
<div class="toc"><ol><li><a href="#asset-bundles">アセットバンドル</a></li>
<li><a href="#defining-asset-bundles">アセットバンドルを定義する</a></li>
<li><a href="#using-asset-bundles">アセットバンドルを使う</a></li>
<li><a href="#common-asset-bundles">よく使われるアセットバンドル</a></li>
<li><a href="#asset-conversion">アセット変換</a></li>
<li><a href="#combining-compressing-assets">アセットを結合して圧縮する</a></li></ol></div>
<p>Yii では、アセットは、ウェブページで参照できるファイルを意味します。
アセットは CSS ファイルであったり、JavaScript ファイルであったり、画像やビデオのファイルであったりします。
アセットはウェブでアクセス可能なディレクトリに配置され、ウェブサーバによって直接に提供されます。</p>
<p>たいていの場合、アセットはプログラム的に管理する方が望ましいものです。
例えば、ページの中で <span class="broken-link">yii\jui\DatePicker</span> ウィジェットを使うとき、このウィジェットは必要な CSS と JavaScript のファイルを自動的にインクルードします。
あなたに対して、手作業で必要なファイルを探してインクルードするように要求したりはしません。
そして、このウィジェットを新しいバージョンにアップグレードしたときは、自動的に新しいバージョンのアセットファイルが使用されるようになります。
このチュートリアルでは、Yii によって提供される強力なアセット管理機能について説明します。</p>
<h2>アセットバンドル  <span id="asset-bundles"></span><a href="#asset-bundles" class="hashlink">&para;</a></h2><p>Yii はアセットを <em>アセットバンドル</em> を単位として管理します。アセットバンドルは、簡単に言えば、あるディレクトリの下に集められた一群のアセットです。
<a href="guide-structure-views.html">ビュー</a> の中でアセットバンドルを登録すると、バンドルの中の CSS や JavaScript のファイルがレンダリングされるウェブページに挿入されます。</p>
<h2>アセットバンドルを定義する  <span id="defining-asset-bundles"></span><a href="#defining-asset-bundles" class="hashlink">&para;</a></h2><p>アセットバンドルは <span class="broken-link">yii\web\AssetBundle</span> から拡張された PHP クラスとして定義されます。
バンドルの名前は、対応する PHP クラスの完全修飾名 (先頭のバックスラッシュを除く) です。
アセットバンドルクラスは <a href="guide-concept-autoloading.html">オートロード可能</a> でなければなりません。
アセットバンドルクラスは、通常、アセットがどこに置かれているか、バンドルがどういう CSS や JavaScript のファイルを含んでいるか、そして、バンドルが他のバンドルにどのように依存しているかを定義します。</p>
<p>以下のコードは <a href="guide-start-installation.html">ベーシックプロジェクトテンプレート</a> によって使用されているメインのアセットバンドルを定義するものです。</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">assets</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">web</span>\<span class="hljs-title">AssetBundle</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppAsset</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AssetBundle</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$basePath</span> = <span class="hljs-string">'@webroot'</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$baseUrl</span> = <span class="hljs-string">'@web'</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$css</span> = [
        <span class="hljs-string">'css/site.css'</span>,
    ];
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$js</span> = [
    ];
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$depends</span> = [
        <span class="hljs-string">'yii\web\YiiAsset'</span>,
        <span class="hljs-string">'yii\bootstrap\BootstrapAsset'</span>,
    ];
}
</code></pre>
<p>上の <code>AppAsset</code> クラスは、アセットファイルが <code>@webroot</code> ディレクトリの下に配置されており、それが URL <code>@web</code> に対応することを定義しています。
バンドルは一つだけ CSS ファイル <code>css/site.css</code> を含み、JavaScript ファイルは含みません。
バンドルは、他の二つのバンドル、すなわち <span class="broken-link">yii\web\YiiAsset</span> と <span class="broken-link">yii\bootstrap\BootstrapAsset</span> に依存しています。
以下、<span class="broken-link">yii\web\AssetBundle</span> のプロパティに関して、更に詳細に説明します。</p>
<ul>
<li><p>ルートディレクトリがウェブからアクセス可能でない場合に、このプロパティをセットしなければなりません。
そうでない場合は、代りに、<span class="broken-link">yii\web\AssetBundle::basePath</span> と <span class="broken-link">yii\web\AssetBundle::baseUrl</span> のプロパティをセットしなければなりません。
<a href="guide-concept-aliases.html">パスエイリアス</a> をここで使うことが出来ます。</p>
</li>
<li><p><span class="broken-link">yii\web\AssetBundle::sourcePath</span> プロパティをセットした場合は、<a href="#asset-manager">アセットマネージャ</a> がバンドルに含まれるファイルをウェブからアクセス可能なディレクトリに発行して、その結果、このプロパティを上書きします。
アセットファイルが既にウェブからアクセス可能なディレクトリにあり、アセットの発行が必要でない場合に、このプロパティをセットしなければなりません。
<a href="guide-concept-aliases.html">パスエイリアス</a> をここで使うことが出来ます。</p>
</li>
<li><span class="broken-link">yii\web\AssetBundle::baseUrl</span>: <span class="broken-link">yii\web\AssetBundle::basePath</span> ディレクトリに対応する URL を指定します。
<span class="broken-link">yii\web\AssetBundle::basePath</span> と同じように、<span class="broken-link">yii\web\AssetBundle::sourcePath</span> プロパティをセットした場合は、<a href="#asset-manager">アセットマネージャ</a> がアセットを発行して、その結果、このプロパティを上書きします。
<a href="guide-concept-aliases.html">パスエイリアス</a> をここで使うことが出来ます。</li>
<li><span class="broken-link">yii\web\AssetBundle::js</span>: このバンドルに含まれる JavaScript ファイルをリストする配列です。
ディレクトリの区切りとしてフォワードスラッシュ "/" だけを使わなければならないことに注意してください。
それぞれの JavaScript ファイルは、以下の二つの形式のどちらかによって指定することが出来ます。<ul>
<li>ローカルの JavaScript ファイルを表す相対パス (例えば <code>js/main.js</code>)。
実際のファイルのパスは、この相対パスの前に <span class="broken-link">yii\web\AssetManager::basePath</span> を付けることによって決定されます。
また、実際の URL は、この相対パスの前に <span class="broken-link">yii\web\AssetManager::baseUrl</span> を付けることによって決定されます。</li>
<li>外部の JavaScript ファイルを表す絶対 URL。
例えば、<code>http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js</code> や <code>//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js</code> など。</li>
</ul>
</li>
<li><span class="broken-link">yii\web\AssetBundle::css</span>: このバンドルに含まれる CSS ファイルをリストする配列です。
この配列の形式は、<span class="broken-link">yii\web\AssetBundle::js</span> の形式と同じです。</li>
<li><p> (バンドルの依存関係については、すぐ後で説明します)。</p>
</li>
<li><span class="broken-link">yii\web\AssetBundle::jsOptions</span>: このバンドルにある <em>全て</em> の JavaScript ファイルについて、それを登録するときに呼ばれる <span class="broken-link">yii\web\View::registerJsFile()</span> メソッドに渡されるオプションを指定します。</li>
<li><span class="broken-link">yii\web\AssetBundle::publishOptions</span>: ソースのアセットファイルをウェブディレクトリに発行するときに呼ばれる <span class="broken-link">yii\web\AssetManager::publish()</span> メソッドに渡されるオプションを指定します。
これは <span class="broken-link">yii\web\AssetBundle::sourcePath</span> プロパティを指定した場合にだけ使用されます。</li>
</ul>
<h3>アセットの配置場所  <span id="asset-locations"></span><a href="#asset-locations" class="hashlink">&para;</a></h3><p>アセットは、配置場所を基準にして、次のように分類することが出来ます。</p>
<ul>
<li>ソースアセット: アセットファイルは、ウェブ経由で直接にアクセスすることが出来ない PHP ソースコードと一緒に配置されています。
ページの中でソースアセットを使用するためには、ウェブディレクトリにコピーして、いわゆる発行されたアセットに変換しなければなりません。
このプロセスは、すぐ後で詳しく説明しますが、<em>アセット発行</em> と呼ばれます。</li>
<li>発行されたアセット: アセットファイルはウェブディレクトリに配置されており、したがってウェブ経由で直接にアクセスすることが出来ます。</li>
<li>外部アセット: アセットファイルは、あなたのウェブアプリケーションをホストしているのとは別のウェブサーバ上に配置されています。</li>
</ul>
<p>アセットバンドルクラスを定義するときに、<span class="broken-link">yii\web\AssetBundle::sourcePath</span> プロパティを指定した場合は、相対パスを使ってリストに挙げられたアセットは全てソースアセットであると見なされます。
このプロパティを指定しなかった場合は、アセットは発行されたアセットであることになります
(したがって、<span class="broken-link">yii\web\AssetBundle::basePath</span> と <span class="broken-link">yii\web\AssetBundle::baseUrl</span> を指定して、アセットがどこに配置されているかを Yii に知らせなければなりません)。</p>
<p>アプリケーションに属するアセットは、不要なアセット発行プロセスを避けるために、ウェブディレクトリに置くことが推奨されます。
前述の例において <code>AppAsset</code> が <span class="broken-link">yii\web\AssetBundle::sourcePath</span> ではなく <span class="broken-link">yii\web\AssetBundle::basePath</span> を指定しているのは、これが理由です。</p>
<p><a href="guide-structure-extensions.html">エクステンション</a> の場合は、アセットがソースコードと一緒にウェブからアクセス出来ないディレクトリに配置されているため、アセットバンドルクラスを定義するときには <span class="broken-link">yii\web\AssetBundle::sourcePath</span> プロパティを指定しなければなりません。</p>
<blockquote class="note"><p><strong>Note: </strong><code>@webroot/assets</code> を <span class="broken-link">yii\web\AssetBundle::sourcePath</span> として使ってはいけません。
  このディレクトリは、デフォルトでは、<span class="broken-link">yii\web\AssetManager</span> がソースの配置場所から発行されたアセットファイルを保存する場所として使われます。
  このディレクトリの中のファイルはすべて一時的なものと見なされており、削除されることがあります。</p>
</blockquote>
<h3>アセットの依存関係  <span id="asset-dependencies"></span><a href="#asset-dependencies" class="hashlink">&para;</a></h3><p>ウェブページに複数の CSS や JavaScript ファイルをインクルードするときは、オーバーライドの問題を避けるために、一定の順序に従わなければなりません。
例えば、ウェブページで jQuery UI ウィジェットを使おうとするときは、jQuery JavaScript ファイルが jQuery UI JavaScript ファイルより前にインクルードされることを保証しなければなりません。
このような順序付けをアセット間の依存関係と呼びます。</p>
<p>アセットの依存関係は、主として、<span class="broken-link">yii\web\AssetBundle::depends</span> プロパティによって指定されます。
<code>AppAsset</code> の例では、このアセットバンドルは他の二つのアセットバンドル、すなわち、<span class="broken-link">yii\web\YiiAsset</span> と <span class="broken-link">yii\bootstrap\BootstrapAsset</span> に依存しています。
このことは、<code>AppAsset</code> の CSS と JavaScript ファイルが、依存している二つのアセットバンドルにあるファイルの <em>後に</em> インクルードされることを意味します。</p>
<p>アセットの依存関係は中継されます。つまり、バンドル A が B に依存し、B が C に依存していると、A は C にも依存していることになります。</p>
<h3>アセットのオプション  <span id="asset-options"></span><a href="#asset-options" class="hashlink">&para;</a></h3><p><span class="broken-link">yii\web\AssetBundle::cssOptions</span> および <span class="broken-link">yii\web\AssetBundle::jsOptions</span> のプロパティを指定して、CSS と JavaScript ファイルがページにインクルードされる方法をカスタマイズすることが出来ます。
これらのプロパティの値は、<a href="guide-structure-views.html">ビュー</a> が CSS と JavaScript ファイルをインクルードするために、<span class="broken-link">yii\web\View::registerCssFile()</span> および <span class="broken-link">yii\web\View::registerJsFile()</span> メソッドを呼ぶときに、それぞれ、オプションとして引き渡されます。</p>
<blockquote class="note"><p><strong>Note: </strong>バンドルクラスでセットしたオプションは、バンドルの中の <em>全て</em> の CSS/JavaScript ファイルに適用されます。
  いろいろなファイルに別々のオプションを使用したい場合は、別々のアセットバンドルを作成して、個々のバンドルの中では、一組のオプションを使うようにしなければなりません。</p>
</blockquote>
<p>例えば、IE9 以下のブラウザに対して CSS ファイルを条件的にインクルードするために、次のオプションを使うことが出来ます。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-variable">$cssOptions</span> = [<span class="hljs-string">'condition'</span> =&gt; <span class="hljs-string">'lte IE9'</span>];
</code></pre>
<p>こうすると、バンドルの中の CSS ファイルは下記の HTML タグを使ってインクルードされるようになります。</p>
<pre><code class="hljs xml language-html"><span class="hljs-comment">&lt;!--[if lte IE9]&gt;
&lt;link rel="stylesheet" href="path/to/foo.css"&gt;
&lt;![endif]--&gt;</span>
</code></pre>
<p>生成された CSS のリンクタグを <code>&lt;noscript&gt;</code> の中に包むためには、次のように <code>cssOptions</code> を構成することが出来ます。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-variable">$cssOptions</span> = [<span class="hljs-string">'noscript'</span> =&gt; <span class="hljs-keyword">true</span>];
</code></pre>
<p>JavaScript ファイルをページの head セクションにインクルードするためには、次のオプションを使います
(デフォルトでは、JavaScript ファイルは body セクションの最後にインクルードされます)。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-variable">$jsOptions</span> = [<span class="hljs-string">'position'</span> =&gt; \yii\web\View::POS_HEAD];
</code></pre>
<p>デフォルトでは、アセットバンドルが発行されるときは、<span class="broken-link">yii\web\AssetBundle::sourcePath</span> で指定されたディレクトリの中にある全てのコンテントが発行されます。
<span class="broken-link">yii\web\AssetBundle::publishOptions</span> プロパティを構成することによって、この振る舞いをカスタマイズすることが出来ます。
例えば、<span class="broken-link">yii\web\AssetBundle::sourcePath</span> の一個または数個のサブディレクトリだけを発行するために、アセットバンドルクラスの中で下記のようにすることが出来ます。</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">assets</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">web</span>\<span class="hljs-title">AssetBundle</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FontAwesomeAsset</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AssetBundle</span> 
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$sourcePath</span> = <span class="hljs-string">'@bower/font-awesome'</span>; 
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$css</span> = [ 
        <span class="hljs-string">'css/font-awesome.min.css'</span>, 
    ]; 
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$publishOptions</span> = [
        <span class="hljs-string">'only'</span> =&gt; [
            <span class="hljs-string">'fonts/'</span>,
            <span class="hljs-string">'css/'</span>,
        ]
    ];
}  
</code></pre>
<p>上記の例は、<a href="http://fontawesome.io/">"fontawesome" パッケージ</a> のためのアセットバンドルを定義するものです。
発行オプション <code>only</code> を指定して、<code>fonts</code> と <code>css</code> サブディレクトリだけが発行されるようにしています。</p>
<h3>Bower と NPM のアセット  <span id="bower-npm-assets"></span><a href="#bower-npm-assets" class="hashlink">&para;</a></h3><p>ほとんどの JavaScript/CSS パッケージは、<a href="http://bower.io/">Bower</a> および/または <a href="https://www.npmjs.org/">NPM</a> によって管理されています。
あなたのアプリケーションやエクステンションがそのようなパッケージを使っている場合は、以下のステップに従って、ライブラリの中のアセットを管理することが推奨されます。</p>
<ol>
<li>アプリケーションまたはエクステンションの <code>composer.json</code> ファイルを修正して、パッケージを <code>require</code> のエントリに入れます。
ライブラリを参照するのに、<code>bower-asset/PackageName</code> (Bower パッケージ) または <code>npm-asset/PackageName</code> (NPM パッケージ) を使わなければなりません。</li>
<li>アセットバンドルクラスを作成して、アプリケーションまたはエクステンションで使う予定の JavaScript/CSS ファイルをリストに挙げます。
<span class="broken-link">yii\web\AssetBundle::sourcePath</span> プロパティは、<code>@bower/PackageName</code> または <code>@npm/PackageName</code> としなければなりません。
これは、Composer が Bower または NPM パッケージを、このエイリアスに対応するディレクトリにインストールするためです。</li>
</ol>
<blockquote class="note"><p><strong>Note: </strong>パッケージの中には、全ての配布ファイルをサブディレクトリに置くものがあります。
  その場合には、そのサブディレクトリを <span class="broken-link">yii\web\AssetBundle::sourcePath</span> の値として指定しなければなりません。
  例えば、<span class="broken-link">yii\web\JqueryAsset</span> は <code>@bower/jquery</code> ではなく <code>@bower/jquery/dist</code> を使います。</p>
</blockquote>
<h2>アセットバンドルを使う  <span id="using-asset-bundles"></span><a href="#using-asset-bundles" class="hashlink">&para;</a></h2><p>アセットバンドルを使うためには、<span class="broken-link">yii\web\AssetBundle::register()</span> メソッドを呼んでアセットバンドルを <a href="guide-structure-views.html">ビュー</a> に登録します。
例えば、次のようにしてビューテンプレートの中でアセットバンドルを登録することが出来ます。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">assets</span>\<span class="hljs-title">AppAsset</span>;
AppAsset::register(<span class="hljs-variable">$this</span>);  <span class="hljs-comment">// $this はビューオブジェクトを表す</span>
</code></pre>
<blockquote class="info"><p><strong>Info: </strong><span class="broken-link">yii\web\AssetBundle::register()</span> メソッドは、<span class="broken-link">yii\web\AssetBundle::basePath</span> や <span class="broken-link">yii\web\AssetBundle::baseUrl</span> など、発行されたアセットに関する情報を含むアセットバンドルオブジェクトを返します。</p>
</blockquote>
<p>他の場所でアセットバンドルを登録しようとするときは、必要とされるビューオブジェクトを提供しなければなりません。
例えば、<a href="guide-structure-widgets.html">ウィジェット</a> クラスの中でアセットバンドルを登録するためには、<code>$this-&gt;view</code> によってビューオブジェクトを取得することが出来ます。</p>
<p>アセットバンドルがビューに登録されるとき、舞台裏では、依存している全てのアセットバンドルが Yii によって登録されます。
そして、アセットバンドルがウェブからはアクセス出来ないディレクトリに配置されている場合は、アセットバンドルがウェブディレクトリに発行されます。
その後、ビューがページをレンダリングするときに、登録されたバンドルのリストに挙げられている CSS と JavaScript ファイルのための <code>&lt;link&gt;</code> タグと <code>&lt;script&gt;</code> タグが生成されます。
これらのタグの順序は、登録されたバンドル間の依存関係、および、<span class="broken-link">yii\web\AssetBundle::css</span> と <span class="broken-link">yii\web\AssetBundle::js</span> のプロパティのリストに挙げられたアセットの順序によって決定されます。</p>
<h3>アセットバンドルをカスタマイズする  <span id="customizing-asset-bundles"></span><a href="#customizing-asset-bundles" class="hashlink">&para;</a></h3><p>Yii は、<span class="broken-link">yii\web\AssetManager</span> によって実装されている <code>assetManager</code> という名前のアプリケーションコンポーネントを通じてアセットバンドルを管理します。
<span class="broken-link">yii\web\AssetManager::bundles</span> プロパティを構成することによって、アセットバンドルの振る舞いをカスタマイズすることが出来ます。
例えば、デフォルトの <span class="broken-link">yii\web\JqueryAsset</span> アセットバンドルはインストールされた jQuery の Bower パッケージにある <code>jquery.js</code> ファイルを使用します。
あなたは、可用性とパフォーマンスを向上させるために、Google によってホストされたバージョンを使いたいと思うかも知れません。
次のように、アプリケーションの構成情報で <code>assetManager</code> を構成することによって、それが達成できます。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'assetManager'</span> =&gt; [
            <span class="hljs-string">'bundles'</span> =&gt; [
                <span class="hljs-string">'yii\web\JqueryAsset'</span> =&gt; [
                    <span class="hljs-string">'sourcePath'</span> =&gt; <span class="hljs-keyword">null</span>,   <span class="hljs-comment">// バンドルを発行しない</span>
                    <span class="hljs-string">'js'</span> =&gt; [
                        <span class="hljs-string">'//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js'</span>,
                    ]
                ],
            ],
        ],
    ],
];
</code></pre>
<p>複数のアセットバンドルも同様に <span class="broken-link">yii\web\AssetManager::bundles</span> によって構成することが出来ます。
配列のキーは、アセットバンドルのクラス名 (最初のバックスラッシュを除く) とし、配列の値は、対応する <a href="guide-concept-configurations.html">構成情報配列</a> とします。</p>
<blockquote class="tip"><p><strong>Tip: </strong>アセットバンドルの中で使うアセットを条件的に選択することが出来ます。
次の例は、開発環境では <code>jquery.js</code> を使い、そうでなければ <code>jquery.min.js</code> を使う方法を示すものです。</p>
<pre><code class="hljs php language-php"><span class="hljs-string">'yii\web\JqueryAsset'</span> =&gt; [
    <span class="hljs-string">'js'</span> =&gt; [
        YII_ENV_DEV ? <span class="hljs-string">'jquery.js'</span> : <span class="hljs-string">'jquery.min.js'</span>
    ]
],
</code></pre>
</blockquote>
<p>無効にしたいアセットバンドルの名前に <code>false</code> を結びつけることによって、一つまたは複数のアセットバンドルを無効にすることが出来ます。
無効にされたアセットバンドルをビューに登録した場合は、依存するバンドルは一つも登録されません。
また、ビューがページをレンダリングするときも、バンドルの中のアセットは一つもインクルードされません。
例えば、<span class="broken-link">yii\web\JqueryAsset</span> を無効化するために、次の構成情報を使用することが出来ます。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'assetManager'</span> =&gt; [
            <span class="hljs-string">'bundles'</span> =&gt; [
                <span class="hljs-string">'yii\web\JqueryAsset'</span> =&gt; <span class="hljs-keyword">false</span>,
            ],
        ],
    ],
];
</code></pre>
<p><span class="broken-link">yii\web\AssetManager::bundles</span> を <code>false</code> にセットすることによって、<em>全て</em> のバンドルを無効にすることも出来ます。</p>
<h3>アセットマッピング  <span id="asset-mapping"></span><a href="#asset-mapping" class="hashlink">&para;</a></h3><p>時として、複数のアセットバンドルで使われている 正しくない/互換でない アセットファイルパスを「修正」したい場合があります。
例えば、バンドル A がバージョン 1.11.1 の <code>jquery.min.js</code> を使い、バンドル B がバージョン 2.1.1 の <code>jquery.js</code> を使っているような場合です。
それぞれのバンドルをカスタマイズすることで問題を修正することも出来ますが、それよりも簡単な方法は、<em>アセットマップ</em> 機能を使って、正しくないアセットを望ましいアセットに割り付けることです。
そうするためには、以下のように <span class="broken-link">yii\web\AssetManager::assetMap</span> プロパティを構成します。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'assetManager'</span> =&gt; [
            <span class="hljs-string">'assetMap'</span> =&gt; [
                <span class="hljs-string">'jquery.js'</span> =&gt; <span class="hljs-string">'//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js'</span>,
            ],
        ],
    ],
];
</code></pre>
<p><span class="broken-link">yii\web\AssetManager::assetMap</span> のキーは修正したいアセットの名前であり、値は望ましいアセットのパスです。
アセットバンドルをビューに登録するとき、<span class="broken-link">yii\web\AssetBundle::css</span> と <span class="broken-link">yii\web\AssetBundle::js</span> の配列に含まれるすべてのアセットファイルの相対パスがこのマップと突き合わせて調べられます。
キーのどれかがアセットファイルのパス (利用できる場合は、<span class="broken-link">yii\web\AssetBundle::sourcePath</span> が前置されます) の最後の部分と一致した場合は、対応する値によってアセットが置き換えられ、ビューに登録されます。
例えば、<code>my/path/to/jquery.js</code> というアセットファイルは <code>jquery.js</code> というキーにマッチします。</p>
<blockquote class="note"><p><strong>Note: </strong>相対パスを使って指定されたアセットだけがアセットマッピングの対象になります。
  そして、置き換える側のアセットのパスは、絶対 URL であるか、<span class="broken-link">yii\web\AssetManager::basePath</span> からの相対パスであるかの、どちらかでなければなりません。</p>
</blockquote>
<h3>アセット発行  <span id="asset-publishing"></span><a href="#asset-publishing" class="hashlink">&para;</a></h3><p>既に述べたように、アセットバンドルがウェブからアクセス出来ないディレクトリに配置されている場合は、バンドルがビューに登録されるときに、アセットがウェブディレクトリにコピーされます。
このプロセスは <em>アセット発行</em> と呼ばれ、<span class="broken-link">yii\web\AssetManager</span> によって自動的に実行されます。</p>
<p>デフォルトでは、アセットが発行されるディレクトリは <code>@webroot/assets</code> であり、<code>@web/assets</code> という URL に対応するものです。
この場所は、<span class="broken-link">yii\web\AssetManager::basePath</span> と <span class="broken-link">yii\web\AssetManager::baseUrl</span> のプロパティを構成してカスタマイズすることが出来ます。</p>
<p>ファイルをコピーすることでアセットを発行する代りに、OS とウェブサーバが許容するなら、シンボリックリンクを使うことを考慮しても良いでしょう。
この機能は <span class="broken-link">yii\web\AssetManager::linkAssets</span> を true にセットすることで有効にすることが出来ます。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'assetManager'</span> =&gt; [
            <span class="hljs-string">'linkAssets'</span> =&gt; <span class="hljs-keyword">true</span>,
        ],
    ],
];
</code></pre>
<p>上記の構成によって、アセットマネージャはアセットバンドルを発行するときにソースパスへのシンボリックリンクを作成するようになります。
この方がファイルのコピーより速く、また、発行されたアセットが常に最新であることを保証することも出来ます。</p>
<h2>よく使われるアセットバンドル  <span id="common-asset-bundles"></span><a href="#common-asset-bundles" class="hashlink">&para;</a></h2><p>コアの Yii コードは多くのアセットバンドルを定義しています。
その中で、下記のバンドルはよく使われるものであり、あなたのアプリケーションやエクステンションのコードでも参照することが出来るものです。</p>
<ul>
<li><span class="broken-link">yii\web\YiiAsset</span>: 主として <code>yii.js</code> ファイルをインクルードするためのバンドルです。
このファイルはモジュール化された JavaScript のコードを編成するメカニズムを実装しています。
また、<code>data-method</code> と <code>data-confirm</code> の属性に対する特別なサポートや、その他の有用な機能を提供します。</li>
<li><span class="broken-link">yii\web\JqueryAsset</span>: jQuery の bower パッケージから <code>jquery.js</code> ファイルをインクルードします。</li>
<li><span class="broken-link">yii\bootstrap\BootstrapAsset</span>: Twitter Bootstrap フレームワークから CSS ファイルをインクルードします。</li>
<li><span class="broken-link">yii\bootstrap\BootstrapPluginAsset</span>: Bootstrap JavaScript プラグインをサポートするために、Twitter Bootstrap フレームワークから JavaScript ファイルをインクルードします。</li>
<li><span class="broken-link">yii\jui\JuiAsset</span>: jQuery UI ライブラリから CSS と JavaScript のファイルをインクルードします。</li>
</ul>
<p>あなたのコードが、jQuery や jQuery UI または Bootstrap に依存する場合は、自分自身のバージョンを作るのではなく、これらの定義済みのアセットバンドルを使用すべきです。
これらのバンドルのデフォルトの設定があなたの必要を満たさない時は、<a href="#customizing-asset-bundles">アセットバンドルをカスタマイズする</a> の項で説明したように、それをカスタマイズすることが出来ます。</p>
<h2>アセット変換  <span id="asset-conversion"></span><a href="#asset-conversion" class="hashlink">&para;</a></h2><p>直接に CSS および/または JavaScript のコードを書く代りに、何らかの拡張構文を使って書いたものを特別なツールを使って CSS/JavaScript に変換する、ということを開発者はしばしば行います。
例えば、CSS コードのためには、<a href="http://lesscss.org/">LESS</a> や <a href="http://sass-lang.com/">SCSS</a> を使うことが出来ます。
また、JavaScript のためには、<a href="http://www.typescriptlang.org/">TypeScript</a> を使うことが出来ます。</p>
<p>拡張構文を使ったアセットファイルをアセットバンドルの中の <span class="broken-link">yii\web\AssetBundle::css</span> と <span class="broken-link">yii\web\AssetBundle::js</span> のリストに挙げることが出来ます。
例えば、</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppAsset</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AssetBundle</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$basePath</span> = <span class="hljs-string">'@webroot'</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$baseUrl</span> = <span class="hljs-string">'@web'</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$css</span> = [
        <span class="hljs-string">'css/site.less'</span>,
    ];
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$js</span> = [
        <span class="hljs-string">'js/site.ts'</span>,
    ];
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$depends</span> = [
        <span class="hljs-string">'yii\web\YiiAsset'</span>,
        <span class="hljs-string">'yii\bootstrap\BootstrapAsset'</span>,
    ];
}
</code></pre>
<p>このようなアセットバンドルをビューに登録すると、<span class="broken-link">yii\web\AssetManager</span> が自動的にプリプロセッサツールを走らせて、認識できた拡張構文のアセットを CSS/JavaScript に変換します。
最終的にビューがページをレンダリングするときには、ビューは元の拡張構文のアセットではなく、変換後の CSS/JavaScript ファイルをページにインクルードします。</p>
<p>Yii はファイル名の拡張子を使って、アセットが使っている拡張構文を識別します。デフォルトでは、下記の構文とファイル名拡張子を認識します。</p>
<ul>
<li><a href="http://lesscss.org/">LESS</a>: <code>.less</code></li>
<li><a href="http://sass-lang.com/">SCSS</a>: <code>.scss</code></li>
<li><a href="http://learnboost.github.io/stylus/">Stylus</a>: <code>.styl</code></li>
<li><a href="http://coffeescript.org/">CoffeeScript</a>: <code>.coffee</code></li>
<li><a href="http://www.typescriptlang.org/">TypeScript</a>: <code>.ts</code></li>
</ul>
<p>Yii はインストールされたプリプロセッサツールに頼ってアセットを変換します。
例えば、<a href="http://lesscss.org/">LESS</a> を使うためには、<code>lessc</code> プリプロセッサコマンドをインストールしなければなりません。</p>
<p>下記のように <span class="broken-link">yii\web\AssetManager::converter</span> を構成することで、プリプロセッサコマンドとサポートされる拡張構文をカスタマイズすることが出来ます。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'assetManager'</span> =&gt; [
            <span class="hljs-string">'converter'</span> =&gt; [
                <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\web\AssetConverter'</span>,
                <span class="hljs-string">'commands'</span> =&gt; [
                    <span class="hljs-string">'less'</span> =&gt; [<span class="hljs-string">'css'</span>, <span class="hljs-string">'lessc {from} {to} --no-color'</span>],
                    <span class="hljs-string">'ts'</span> =&gt; [<span class="hljs-string">'js'</span>, <span class="hljs-string">'tsc --out {to} {from}'</span>],
                ],
            ],
        ],
    ],
];
</code></pre>
<p>上記においては、サポートされる拡張構文が <span class="broken-link">yii\web\AssetConverter::commands</span> プロパティによって定義されています。
配列のキーはファイルの拡張子 (先頭のドットは省く) であり、配列の値は結果として作られるアセットファイルの拡張子とアセット変換を実行するためのコマンドです。
コマンドの中の <code>{from}</code> と <code>{to}</code> のトークンは、ソースのアセットファイルのパスとターゲットのアセットファイルのパスに置き換えられます。</p>
<blockquote class="info"><p><strong>Info: </strong>上記で説明した方法の他にも、拡張構文のアセットを扱う方法はあります。
  例えば、<a href="http://gruntjs.com/">grunt</a> のようなビルドツールを使って、拡張構文のアセットをモニターし、自動的に変換することが出来ます。
  この場合は、元のファイルではなく、結果として作られる CSS/JavaScript ファイルをアセットバンドルのリストに挙げなければなりません。</p>
</blockquote>
<h2>アセットを結合して圧縮する  <span id="combining-compressing-assets"></span><a href="#combining-compressing-assets" class="hashlink">&para;</a></h2><p>ウェブページは数多くの CSS および/または JavaScript ファイルをインクルードすることがあり得ます。
HTTP リクエストの数とこれらのファイルの全体としてのダウンロードサイズを削減するためによく用いられる方法は、複数の CSS/JavaScript ファイルを結合して圧縮し、一つまたはごく少数のファイルにまとめることです。
そして、ウェブページでは元のファイルをインクルードする代りに、圧縮されたファイルをインクルードする訳です。</p>
<blockquote class="info"><p><strong>Info: </strong>アセットの結合と圧縮は、通常はアプリケーションが本番モードにある場合に必要になります。
  開発モードにおいては、たいていは元の CSS/JavaScript ファイルを使う方がデバッグのために好都合です。</p>
</blockquote>
<p>次に、既存のアプリケーションコードを修正する必要なしに、アセットファイルを結合して圧縮する方法を紹介します。</p>
<ol>
<li>アプリケーションの中で、結合して圧縮する予定のアセットバンドルを全て探し出す。</li>
<li>これらのバンドルを一個か数個のグループにまとめる。どのバンドルも一つのグループにしか属することが出来ないことに注意。</li>
<li>各グループの CSS ファイルを一つのファイルに結合/圧縮する。JavaScript ファイルに対しても同様にこれを行う。</li>
<li>各グループに対して新しいアセットバンドルを定義する。<ul>
<li><span class="broken-link">yii\web\AssetBundle::css</span> と <span class="broken-link">yii\web\AssetBundle::js</span> のプロパティに、それぞれ、結合された CSS ファイルと JavaScript ファイルをセットする。</li>
<li>各グループに属する元のアセットバンドルをカスタマイズして、<span class="broken-link">yii\web\AssetBundle::css</span> と <span class="broken-link">yii\web\AssetBundle::js</span> のプロパティを空にし、<span class="broken-link">yii\web\AssetBundle::depends</span> プロパティにグループのために作られた新しいバンドルを指定する。</li>
</ul>
</li>
</ol>
<p>この方法を使うと、ビューでアセットバンドルを登録したときに、元のバンドルが属するグループのための新しいアセットバンドルが自動的に登録されるようになります。
そして、結果として、結合/圧縮されたアセットファイルが、元のファイルの代りに、ページにインクルードされます。</p>
<h3>一例  <span id="example"></span><a href="#example" class="hashlink">&para;</a></h3><p>上記の方法をさらに説明するために一つの例を挙げましょう。</p>
<p>あなたのアプリケーションが二つのページ、X と Y を持つと仮定します。
ページ X はアセットバンドル A、B、C を使用し、ページ Y はアセットバンドル B、C、D を使用します。</p>
<p>これらのアセットバンドルを分割する方法は二つあります。一つは単一のグループを使用して全てのアセットバンドルを含める方法です。
もう一つは、A をグループ X に入れ、D をグループ Y に入れ、そして、B と C をグループ S に入れる方法です。どちらが良いでしょう? 場合によります。
最初の方法の利点は、二つのページが同一の結合された CSS と JavaScript のファイルを共有するため、HTTP キャッシュの効果が高くなることです。
その一方で、単一のグループが全てのバンドルを含むために、結合された CSS と JavaScript のファイルはより大きくなり、従って最初のファイル転送時間はより長くなります。
この例では話を簡単にするために、最初の方法、すなわち、全てのバンドルを含む単一のグループを使用することにします。</p>
<blockquote class="info"><p><strong>Info: </strong>アセットバンドルをグループに分けることは些細な仕事ではありません。
  通常、そのためには、いろいろなページのさまざまなアセットの現実世界での転送量を分析することが必要になります。
  とりあえず、最初は、簡単にするために、単一のグループから始めて良いでしょう。</p>
</blockquote>
<p>既存のツール (例えば <a href="https://developers.google.com/closure/compiler/">Closure Compiler</a> や <a href="https://github.com/yui/yuicompressor/">YUI Compressor</a>) を使って、全てのバンドルにある CSS と JavaScript のファイルを結合して圧縮します。
ファイルは、バンドル間の依存関係を満たす順序に従って結合しなければならないことに注意してください。
例えば、バンドル A が B に依存し、B が C と D の両方に依存している場合は、アセットファイルの結合順は、最初に C と D、次に B、そして最後に A としなければなりません。</p>
<p>結合と圧縮が完了すると、一つの CSS ファイルと一つの JavaScript ファイルが得られます。
それらは、<code>all-xyz.css</code> および <code>all-xyz.js</code> と命名されたとしましょう。
ここで <code>xyz</code> は、ファイル名をユニークにして HTTP キャッシュの問題を避けるために使用されるタイムスタンプまたはハッシュを表します。</p>
<p>いよいよ最終ステップです。
アプリケーションの構成情報の中で、<span class="broken-link">yii\web\AssetManager</span> を次のように構成します。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'assetManager'</span> =&gt; [
            <span class="hljs-string">'bundles'</span> =&gt; [
                <span class="hljs-string">'all'</span> =&gt; [
                    <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\web\AssetBundle'</span>,
                    <span class="hljs-string">'basePath'</span> =&gt; <span class="hljs-string">'@webroot/assets'</span>,
                    <span class="hljs-string">'baseUrl'</span> =&gt; <span class="hljs-string">'@web/assets'</span>,
                    <span class="hljs-string">'css'</span> =&gt; [<span class="hljs-string">'all-xyz.css'</span>],
                    <span class="hljs-string">'js'</span> =&gt; [<span class="hljs-string">'all-xyz.js'</span>],
                ],
                <span class="hljs-string">'A'</span> =&gt; [<span class="hljs-string">'css'</span> =&gt; [], <span class="hljs-string">'js'</span> =&gt; [], <span class="hljs-string">'depends'</span> =&gt; [<span class="hljs-string">'all'</span>]],
                <span class="hljs-string">'B'</span> =&gt; [<span class="hljs-string">'css'</span> =&gt; [], <span class="hljs-string">'js'</span> =&gt; [], <span class="hljs-string">'depends'</span> =&gt; [<span class="hljs-string">'all'</span>]],
                <span class="hljs-string">'C'</span> =&gt; [<span class="hljs-string">'css'</span> =&gt; [], <span class="hljs-string">'js'</span> =&gt; [], <span class="hljs-string">'depends'</span> =&gt; [<span class="hljs-string">'all'</span>]],
                <span class="hljs-string">'D'</span> =&gt; [<span class="hljs-string">'css'</span> =&gt; [], <span class="hljs-string">'js'</span> =&gt; [], <span class="hljs-string">'depends'</span> =&gt; [<span class="hljs-string">'all'</span>]],
            ],
        ],
    ],
];
</code></pre>
<p><a href="#customizing-asset-bundles">アセットバンドルをカスタマイズする</a> の項で説明したように、上記の構成によって元のバンドルは全てデフォルトの振る舞いを変更されます。
具体的にいえば、バンドル A、B、C、D は、もはやアセットファイルを一つも持っていません。
この4つは、それぞれ、結合された <code>all-xyz.css</code> と <code>all-xyz.js</code> ファイルを持つ <code>all</code> バンドルに依存するようになりました。
結果として、ページ X では、バンドル A、B、C から元のソースファイルをインクルードする代りに、これら二つの結合されたファイルだけがインクルードされます。
同じことはページ Y でも起ります。</p>
<p>最後にもう一つ、上記の方法をさらにスムーズに運用するためのトリックがあります。
アプリケーションの構成情報ファイルを直接修正する代りに、バンドルのカスタマイズ用の配列を独立したファイルに置いて、条件によってそのファイルをアプリケーションの構成情報にインクルードすることが出来ます。
例えば、</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'assetManager'</span> =&gt; [
            <span class="hljs-string">'bundles'</span> =&gt; <span class="hljs-keyword">require</span>(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/'</span> . (YII_ENV_PROD ? <span class="hljs-string">'assets-prod.php'</span> : <span class="hljs-string">'assets-dev.php'</span>)),  
        ],
    ],
];
</code></pre>
<p>つまり、アセットバンドルの構成情報配列は、本番モードのものは <code>assets-prod.php</code> に保存し、開発モードのものは <code>assets-dev.php</code> に保存するという訳です。</p>
<h3><code>asset</code> コマンドを使う  <span id="using-asset-command"></span><a href="#using-asset-command" class="hashlink">&para;</a></h3><p>Yii は、たった今説明した方法を自動化するための <code>asset</code> という名前のコンソールコマンドを提供しています。</p>
<p>このコマンドを使うためには、最初に構成情報ファイルを作成して、どのアセットバンドルが結合されるか、そして、それらがどのようにグループ化されるかを記述しなければなりません。
<code>asset/template</code> サブコマンドを使って最初にテンプレートを生成し、それをあなたの要求に合うように修正することが出来ます。</p>
<pre><code class="hljs nginx"><span class="hljs-title">yii</span> asset/template assets.php
</code></pre>
<p>上記のコマンドは、カレントディレクトリに <code>assets.php</code> というファイルを生成します。このファイルの内容は以下のようなものです。</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-comment">/**
 * "yii asset" コンソールコマンドのための構成情報ファイル
 * コンソール環境では、'<span class="hljs-doctag">@webroot</span>' や '<span class="hljs-doctag">@web</span>' のように、存在しないパスエイリアスがあり得ることに注意してください。
 * これらの欠落したパスエイリアスは手作業で定義してください。
 */</span>
<span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// JavaScript ファイルの圧縮のためのコマンド/コールバックを調整。</span>
    <span class="hljs-string">'jsCompressor'</span> =&gt; <span class="hljs-string">'java -jar compiler.jar --js {from} --js_output_file {to}'</span>,
    <span class="hljs-comment">// CSS ファイルの圧縮のためのコマンド/コールバックを調整。</span>
    <span class="hljs-string">'cssCompressor'</span> =&gt; <span class="hljs-string">'java -jar yuicompressor.jar --type css {from} -o {to}'</span>,
    <span class="hljs-comment">// 圧縮するアセットバンドルのリスト。</span>
    <span class="hljs-string">'bundles'</span> =&gt; [
        <span class="hljs-comment">// 'yii\web\YiiAsset',</span>
        <span class="hljs-comment">// 'yii\web\JqueryAsset',</span>
    ],
    <span class="hljs-comment">// 圧縮出力用のアセットバンドル。</span>
    <span class="hljs-string">'targets'</span> =&gt; [
        <span class="hljs-string">'all'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\web\AssetBundle'</span>,
            <span class="hljs-string">'basePath'</span> =&gt; <span class="hljs-string">'@webroot/assets'</span>,
            <span class="hljs-string">'baseUrl'</span> =&gt; <span class="hljs-string">'@web/assets'</span>,
            <span class="hljs-string">'js'</span> =&gt; <span class="hljs-string">'js/all-{hash}.js'</span>,
            <span class="hljs-string">'css'</span> =&gt; <span class="hljs-string">'css/all-{hash}.css'</span>,
        ],
    ],
    <span class="hljs-comment">// アセットマネージャの構成情報</span>
    <span class="hljs-string">'assetManager'</span> =&gt; [
    ],
];
</code></pre>
<p>このファイルを修正して、どのバンドルを結合するつもりであるかを <code>bundles</code> オプションで指定しなければなりません。
<code>targets</code> オプションでは、バンドルがどのようにグループに分割されるかを指定しなければなりません。
既に述べたように、一つまたは複数のグループを定義することが出来ます。</p>
<blockquote class="note"><p><strong>Note: </strong>パスエイリアス <code>@webroot</code> および <code>@web</code> はコンソールアプリケーションでは利用できませんので、これらは構成情報の中で明示的に定義しなければなりません。</p>
</blockquote>
<p>JavaScript ファイルは結合され、圧縮されて <code>js/all-{hash}.js</code> に保存されます。ここで {hash} は、結果として作られたファイルのハッシュで置き換えられるものです。</p>
<p><code>jsCompressor</code> と <code>cssCompressor</code> のオプションは、JavaScript と CSS の結合/圧縮を実行するコンソールコマンドまたは PHP コールバックを指定するものです。
デフォルトでは、Yii は JavaScript ファイルの結合に <a href="https://developers.google.com/closure/compiler/">Closure Compiler</a> を使い、CSS ファイルの結合に <a href="https://github.com/yui/yuicompressor/">YUI Compressor</a> を使用します。
あなたの好みのツールを使うためには、手作業でツールをインストールしたり、オプションを修正したりしなければなりません。</p>
<p>この構成情報ファイルを使い、<code>asset</code> コマンドを走らせて、アセットファイルを結合して圧縮し、同時に、新しいアセットバンドルの構成情報ファイル <code>assets-prod.php</code> を生成することが出来ます。</p>
<pre><code class="hljs nginx"><span class="hljs-title">yii</span> asset assets.php config/assets-prod.php
</code></pre>
<p>直前の項で説明したように、この生成された構成情報ファイルをアプリケーションの構成情報にインクルードすることが出来ます。</p>
<blockquote class="info"><p><strong>Info: </strong><code>asset</code> コマンドを使うことは、アセットの結合・圧縮のプロセスを自動化する唯一の選択肢ではありません。
  優秀なタスク実行ツールである <a href="http://gruntjs.com/">grunt</a> を使っても、同じ目的を達することが出来ます。</p>
</blockquote>
<h3>アセットバンドルをグループ化する  <span id="grouping-asset-bundles"></span><a href="#grouping-asset-bundles" class="hashlink">&para;</a></h3><p>直前の項において、全てのアセットバンドルを一つに結合して、アプリケーションで参照されるアセットファイルに対する HTTP リクエストを最小化する方法を説明しました。
現実には、それが常に望ましいわけではありません。
例えば、あなたのアプリケーションがフロントエンドとバックエンドを持っており、それぞれが異なる一群の JavaScript と CSS ファイルを使う場合を想像してください。
この場合、両方の側の全てのアセットバンドルを一つに結合するのは合理的ではありません。
何故なら、フロントエンドのためのアセットバンドルはバックエンドでは使用されませんから、フロントエンドのページがリクエストされているときにバックエンドのアセットを送信するのはネットワーク帯域の浪費です。</p>
<p>上記の問題を解決するために、アセットバンドルをグループ化して、グループごとにアセットバンドルを結合することが出来ます。
下記の構成情報は、アセットバンドルをグループ化する方法を示すものです。</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    ...
    <span class="hljs-comment">// 出力されるバンドルをグループ化する</span>
    <span class="hljs-string">'targets'</span> =&gt; [
        <span class="hljs-string">'allShared'</span> =&gt; [
            <span class="hljs-string">'js'</span> =&gt; <span class="hljs-string">'js/all-shared-{hash}.js'</span>,
            <span class="hljs-string">'css'</span> =&gt; <span class="hljs-string">'css/all-shared-{hash}.css'</span>,
            <span class="hljs-string">'depends'</span> =&gt; [
                <span class="hljs-comment">// バックエンドとフロントエンドで共有される全てのアセットを含める</span>
                <span class="hljs-string">'yii\web\YiiAsset'</span>,
                <span class="hljs-string">'app\assets\SharedAsset'</span>,
            ],
        ],
        <span class="hljs-string">'allBackEnd'</span> =&gt; [
            <span class="hljs-string">'js'</span> =&gt; <span class="hljs-string">'js/all-{hash}.js'</span>,
            <span class="hljs-string">'css'</span> =&gt; <span class="hljs-string">'css/all-{hash}.css'</span>,
            <span class="hljs-string">'depends'</span> =&gt; [
                <span class="hljs-comment">// バックエンドだけのアセットを含める</span>
                <span class="hljs-string">'app\assets\AdminAsset'</span>
            ],
        ],
        <span class="hljs-string">'allFrontEnd'</span> =&gt; [
            <span class="hljs-string">'js'</span> =&gt; <span class="hljs-string">'js/all-{hash}.js'</span>,
            <span class="hljs-string">'css'</span> =&gt; <span class="hljs-string">'css/all-{hash}.css'</span>,
            <span class="hljs-string">'depends'</span> =&gt; [], <span class="hljs-comment">// 残りの全てのアセットを含める</span>
        ],
    ],
    ...
];
</code></pre>
<p>ご覧のように、アセットバンドルは三つのグループ、すなわち、<code>allShared</code>、<code>allBackEnd</code> および <code>allFrontEnd</code> に分けられています。
そして、それぞれが適切な一群のアセットバンドルに依存しています。
例えば、<code>allBackEnd</code> は <code>app\assets\AdminAsset</code> に依存しています。
この構成情報によって <code>asset</code> コマンドを実行すると、上記の定義に従ってアセットバンドルが結合されます。</p>
<blockquote class="info"><p><strong>Info: </strong>ターゲットバンドルのうちの一つについて <code>depends</code> の構成を空のままにしておくことが出来ます。
  そのようにすると、他のターゲットバンドルが依存しないために残された全てのアセットバンドルが、このターゲットバンドルに含まれるようになります。</p>
</blockquote>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Tue, 27 Dec 2016 22:28:43 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
