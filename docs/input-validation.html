<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/90d046f2/css/bootstrap.css" rel="stylesheet">
<link href="./assets/c6368d94/solarized_light.css" rel="stylesheet">
<link href="./assets/9f5cdd92/style.css" rel="stylesheet">
<script src="./assets/a6e53573/jquery.js"></script>
<script src="./assets/90d046f2/js/bootstrap.js"></script>
<script src="./assets/218ce2e5/jssearch.js"></script>    <title>Validating Input - Getting Data from Users - Videoyii</title>
</head>
<body>

<div class="wrap">
    <nav id="w664" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w664-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Videoyii</a></div><div id="w664-collapse" class="collapse navbar-collapse"><ul id="w665" class="navbar-nav nav"><li><a href="./index.html">Class reference</a></li>
<li><a href="./README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-648" data-toggle="collapse" data-parent="#navigation">Introduction <b class="caret"></b></a><div id="navigation-648" class="submenu panel-collapse collapse"><a class="list-group-item" href="./intro-yii.html">About Yii</a>
<a class="list-group-item" href="./intro-upgrade-from-v1.html">Upgrading from Version 1.1</a></div>
<a class="list-group-item" href="#navigation-649" data-toggle="collapse" data-parent="#navigation">Getting Started <b class="caret"></b></a><div id="navigation-649" class="submenu panel-collapse collapse"><a class="list-group-item" href="./start-installation.html">Installing Yii</a>
<a class="list-group-item" href="./start-workflow.html">Running Applications</a>
<a class="list-group-item" href="./start-hello.html">Saying Hello</a>
<a class="list-group-item" href="./start-forms.html">Working with Forms</a>
<a class="list-group-item" href="./start-databases.html">Working with Databases</a>
<a class="list-group-item" href="./start-gii.html">Generating Code with Gii</a>
<a class="list-group-item" href="./start-looking-ahead.html">Looking Ahead</a></div>
<a class="list-group-item" href="#navigation-650" data-toggle="collapse" data-parent="#navigation">Application Structure <b class="caret"></b></a><div id="navigation-650" class="submenu panel-collapse collapse"><a class="list-group-item" href="./structure-overview.html">Overview</a>
<a class="list-group-item" href="./structure-entry-scripts.html">Entry Scripts</a>
<a class="list-group-item" href="./structure-applications.html">Applications</a>
<a class="list-group-item" href="./structure-application-components.html">Application Components</a>
<a class="list-group-item" href="./structure-controllers.html">Controllers</a>
<a class="list-group-item" href="./structure-models.html">Models</a>
<a class="list-group-item" href="./structure-views.html">Views</a>
<a class="list-group-item" href="./structure-modules.html">Modules</a>
<a class="list-group-item" href="./structure-filters.html">Filters</a>
<a class="list-group-item" href="./structure-widgets.html">Widgets</a>
<a class="list-group-item" href="./structure-assets.html">Assets</a>
<a class="list-group-item" href="./structure-extensions.html">Extensions</a></div>
<a class="list-group-item" href="#navigation-651" data-toggle="collapse" data-parent="#navigation">Handling Requests <b class="caret"></b></a><div id="navigation-651" class="submenu panel-collapse collapse"><a class="list-group-item" href="./runtime-overview.html">Overview</a>
<a class="list-group-item" href="./runtime-bootstrapping.html">Bootstrapping</a>
<a class="list-group-item" href="./runtime-routing.html">Routing and URL Creation</a>
<a class="list-group-item" href="./runtime-requests.html">Requests</a>
<a class="list-group-item" href="./runtime-responses.html">Responses</a>
<a class="list-group-item" href="./runtime-sessions-cookies.html">Sessions and Cookies</a>
<a class="list-group-item" href="./runtime-handling-errors.html">Handling Errors</a>
<a class="list-group-item" href="./runtime-logging.html">Logging</a></div>
<a class="list-group-item" href="#navigation-652" data-toggle="collapse" data-parent="#navigation">Key Concepts <b class="caret"></b></a><div id="navigation-652" class="submenu panel-collapse collapse"><a class="list-group-item" href="./concept-components.html">Components</a>
<a class="list-group-item" href="./concept-properties.html">Properties</a>
<a class="list-group-item" href="./concept-events.html">Events</a>
<a class="list-group-item" href="./concept-behaviors.html">Behaviors</a>
<a class="list-group-item" href="./concept-configurations.html">Configurations</a>
<a class="list-group-item" href="./concept-aliases.html">Aliases</a>
<a class="list-group-item" href="./concept-autoloading.html">Class Autoloading</a>
<a class="list-group-item" href="./concept-service-locator.html">Service Locator</a>
<a class="list-group-item" href="./concept-di-container.html">Dependency Injection Container</a></div>
<a class="list-group-item" href="#navigation-653" data-toggle="collapse" data-parent="#navigation">Working with Databases <b class="caret"></b></a><div id="navigation-653" class="submenu panel-collapse collapse"><a class="list-group-item" href="./db-dao.html">Data Access Objects</a>
<a class="list-group-item" href="./db-query-builder.html">Query Builder</a>
<a class="list-group-item" href="./db-active-record.html">Active Record</a>
<a class="list-group-item" href="./db-migrations.html">Migrations</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-sphinx/blob/master/docs/guide/README.md">Sphinx</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-redis/blob/master/docs/guide/README.md">Redis</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-mongodb/blob/master/docs/guide/README.md">MongoDB</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-elasticsearch/blob/master/docs/guide/README.md">ElasticSearch</a></div>
<a class="list-group-item active" href="#navigation-654" data-toggle="collapse" data-parent="#navigation">Getting Data from Users <b class="caret"></b></a><div id="navigation-654" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./input-forms.html">Creating Forms</a>
<a class="list-group-item active" href="./input-validation.html">Validating Input</a>
<a class="list-group-item" href="./input-file-upload.html">Uploading Files</a>
<a class="list-group-item" href="./input-tabular-input.html">Collecting Tabular Input</a>
<a class="list-group-item" href="./input-multiple-models.html">Getting Data for Multiple Models</a></div>
<a class="list-group-item" href="#navigation-655" data-toggle="collapse" data-parent="#navigation">Displaying Data <b class="caret"></b></a><div id="navigation-655" class="submenu panel-collapse collapse"><a class="list-group-item" href="./output-formatting.html">Data Formatting</a>
<a class="list-group-item" href="./output-pagination.html">Pagination</a>
<a class="list-group-item" href="./output-sorting.html">Sorting</a>
<a class="list-group-item" href="./output-data-providers.html">Data Providers</a>
<a class="list-group-item" href="./output-data-widgets.html">Data Widgets</a>
<a class="list-group-item" href="./output-client-scripts.html">Working with Client Scripts</a>
<a class="list-group-item" href="./output-theming.html">Theming</a></div>
<a class="list-group-item" href="#navigation-656" data-toggle="collapse" data-parent="#navigation">Security <b class="caret"></b></a><div id="navigation-656" class="submenu panel-collapse collapse"><a class="list-group-item" href="./security-overview.html">Overview</a>
<a class="list-group-item" href="./security-authentication.html">Authentication</a>
<a class="list-group-item" href="./security-authorization.html">Authorization</a>
<a class="list-group-item" href="./security-passwords.html">Working with Passwords</a>
<a class="list-group-item" href="./security-cryptography.html">Cryptography</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-authclient/blob/master/docs/guide/README.md">Auth Clients</a>
<a class="list-group-item" href="./security-best-practices.html">Best Practices</a></div>
<a class="list-group-item" href="#navigation-657" data-toggle="collapse" data-parent="#navigation">Caching <b class="caret"></b></a><div id="navigation-657" class="submenu panel-collapse collapse"><a class="list-group-item" href="./caching-overview.html">Overview</a>
<a class="list-group-item" href="./caching-data.html">Data Caching</a>
<a class="list-group-item" href="./caching-fragment.html">Fragment Caching</a>
<a class="list-group-item" href="./caching-page.html">Page Caching</a>
<a class="list-group-item" href="./caching-http.html">HTTP Caching</a></div>
<a class="list-group-item" href="#navigation-658" data-toggle="collapse" data-parent="#navigation">RESTful Web Services <b class="caret"></b></a><div id="navigation-658" class="submenu panel-collapse collapse"><a class="list-group-item" href="./rest-quick-start.html">Quick Start</a>
<a class="list-group-item" href="./rest-resources.html">Resources</a>
<a class="list-group-item" href="./rest-controllers.html">Controllers</a>
<a class="list-group-item" href="./rest-routing.html">Routing</a>
<a class="list-group-item" href="./rest-response-formatting.html">Response Formatting</a>
<a class="list-group-item" href="./rest-authentication.html">Authentication</a>
<a class="list-group-item" href="./rest-rate-limiting.html">Rate Limiting</a>
<a class="list-group-item" href="./rest-versioning.html">Versioning</a>
<a class="list-group-item" href="./rest-error-handling.html">Error Handling</a></div>
<a class="list-group-item" href="#navigation-659" data-toggle="collapse" data-parent="#navigation">Development Tools <b class="caret"></b></a><div id="navigation-659" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-debug/blob/master/docs/guide/README.md">Debug Toolbar and Debugger</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-gii/blob/master/docs/guide/README.md">Generating Code using Gii</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-apidoc">Generating API Documentation</a></div>
<a class="list-group-item" href="#navigation-660" data-toggle="collapse" data-parent="#navigation">Testing <b class="caret"></b></a><div id="navigation-660" class="submenu panel-collapse collapse"><a class="list-group-item" href="./test-overview.html">Overview</a>
<a class="list-group-item" href="./test-environment-setup.html">Testing environment setup</a>
<a class="list-group-item" href="./test-unit.html">Unit Tests</a>
<a class="list-group-item" href="./test-functional.html">Functional Tests</a>
<a class="list-group-item" href="./test-acceptance.html">Acceptance Tests</a>
<a class="list-group-item" href="./test-fixtures.html">Fixtures</a></div>
<a class="list-group-item" href="#navigation-661" data-toggle="collapse" data-parent="#navigation">Special Topics <b class="caret"></b></a><div id="navigation-661" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-app-advanced/blob/master/docs/guide/README.md">Advanced Project Template</a>
<a class="list-group-item" href="./tutorial-start-from-scratch.html">Building Application from Scratch</a>
<a class="list-group-item" href="./tutorial-console.html">Console Commands</a>
<a class="list-group-item" href="./tutorial-core-validators.html">Core Validators</a>
<a class="list-group-item" href="./tutorial-i18n.html">Internationalization</a>
<a class="list-group-item" href="./tutorial-mailing.html">Mailing</a>
<a class="list-group-item" href="./tutorial-performance-tuning.html">Performance Tuning</a>
<a class="list-group-item" href="./tutorial-shared-hosting.html">Shared Hosting Environment</a>
<a class="list-group-item" href="./tutorial-template-engines.html">Template Engines</a>
<a class="list-group-item" href="./tutorial-yii-integration.html">Working with Third-Party Code</a></div>
<a class="list-group-item" href="#navigation-662" data-toggle="collapse" data-parent="#navigation">Widgets <b class="caret"></b></a><div id="navigation-662" class="submenu panel-collapse collapse"><a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-grid-gridview.html">GridView</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-listview.html">ListView</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-detailview.html">DetailView</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/guide-input-forms.html#activerecord-based-forms-activeform">ActiveForm</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-pjax.html">Pjax</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-menu.html">Menu</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-linkpager.html">LinkPager</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-linksorter.html">LinkSorter</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-bootstrap/blob/master/docs/guide/README.md">Bootstrap Widgets</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-jui/blob/master/docs/guide/README.md">jQuery UI Widgets</a></div>
<a class="list-group-item" href="#navigation-663" data-toggle="collapse" data-parent="#navigation">Helpers <b class="caret"></b></a><div id="navigation-663" class="submenu panel-collapse collapse"><a class="list-group-item" href="./helper-overview.html">Overview</a>
<a class="list-group-item" href="./helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./helper-html.html">Html</a>
<a class="list-group-item" href="./helper-url.html">Url</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Validating Input <span id="validating-input"></span><a href="#validating-input" class="hashlink">&para;</a></h1>
<div class="toc"><ol><li><a href="#declaring-rules">Declaring Rules</a></li>
<li><a href="#ad-hoc-validation">Ad Hoc Validation</a></li>
<li><a href="#creating-validators">Creating Validators</a></li>
<li><a href="#multiple-attributes-validation">Multiple Attributes Validation</a></li>
<li><a href="#client-side-validation">Client-Side Validation</a></li></ol></div>
<p>As a rule of thumb, you should never trust the data received from end users and should always validate it
before putting it to good use.</p>
<p>Given a <a href="structure-models.html">model</a> populated with user inputs, you can validate the inputs by calling the
<span class="broken-link">yii\base\Model::validate()</span> method. The method will return a boolean value indicating whether the validation
succeeded or not. If not, you may get the error messages from the <span class="broken-link">yii\base\Model::errors</span> property. For example,</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$model</span> = <span class="hljs-keyword">new</span> \app\models\ContactForm();

<span class="hljs-comment">// populate model attributes with user inputs</span>
<span class="hljs-variable">$model</span>-&gt;load(\Yii::<span class="hljs-variable">$app</span>-&gt;request-&gt;post());
<span class="hljs-comment">// which is equivalent to the following:</span>
<span class="hljs-comment">// $model-&gt;attributes = \Yii::$app-&gt;request-&gt;post('ContactForm');</span>

<span class="hljs-keyword">if</span> (<span class="hljs-variable">$model</span>-&gt;validate()) {
    <span class="hljs-comment">// all inputs are valid</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// validation failed: $errors is an array containing error messages</span>
    <span class="hljs-variable">$errors</span> = <span class="hljs-variable">$model</span>-&gt;errors;
}
</code></pre>
<h2>Declaring Rules  <span id="declaring-rules"></span><a href="#declaring-rules" class="hashlink">&para;</a></h2><p>To make <code>validate()</code> really work, you should declare validation rules for the attributes you plan to validate.
This should be done by overriding the <span class="broken-link">yii\base\Model::rules()</span> method. The following example shows how
the validation rules for the <code>ContactForm</code> model are declared:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> [
        <span class="hljs-comment">// the name, email, subject and body attributes are required</span>
        [[<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>, <span class="hljs-string">'subject'</span>, <span class="hljs-string">'body'</span>], <span class="hljs-string">'required'</span>],

        <span class="hljs-comment">// the email attribute should be a valid email address</span>
        [<span class="hljs-string">'email'</span>, <span class="hljs-string">'email'</span>],
    ];
}
</code></pre>
<p>The <span class="broken-link">yii\base\Model::rules()</span> method should return an array of rules, each of which is an array
of the following format:</p>
<pre><code class="hljs php language-php">[
    <span class="hljs-comment">// required, specifies which attributes should be validated by this rule.</span>
    <span class="hljs-comment">// For a single attribute, you can use the attribute name directly</span>
    <span class="hljs-comment">// without having it in an array</span>
    [<span class="hljs-string">'attribute1'</span>, <span class="hljs-string">'attribute2'</span>, ...],

    <span class="hljs-comment">// required, specifies the type of this rule.</span>
    <span class="hljs-comment">// It can be a class name, validator alias, or a validation method name</span>
    <span class="hljs-string">'validator'</span>,

    <span class="hljs-comment">// optional, specifies in which scenario(s) this rule should be applied</span>
    <span class="hljs-comment">// if not given, it means the rule applies to all scenarios</span>
    <span class="hljs-comment">// You may also configure the "except" option if you want to apply the rule</span>
    <span class="hljs-comment">// to all scenarios except the listed ones</span>
    <span class="hljs-string">'on'</span> =&gt; [<span class="hljs-string">'scenario1'</span>, <span class="hljs-string">'scenario2'</span>, ...],

    <span class="hljs-comment">// optional, specifies additional configurations for the validator object</span>
    <span class="hljs-string">'property1'</span> =&gt; <span class="hljs-string">'value1'</span>, <span class="hljs-string">'property2'</span> =&gt; <span class="hljs-string">'value2'</span>, ...
]
</code></pre>
<p>For each rule you must specify at least which attributes the rule applies to and what is the type of the rule.
You can specify the rule type in one of the following forms:</p>
<ul>
<li>the alias of a core validator, such as <code>required</code>, <code>in</code>, <code>date</code>, etc. Please refer to
the <a href="tutorial-core-validators.html">Core Validators</a> for the complete list of core validators.</li>
<li>the name of a validation method in the model class, or an anonymous function. Please refer to the
<a href="#inline-validators">Inline Validators</a> subsection for more details.</li>
<li>a fully qualified validator class name. Please refer to the <a href="#standalone-validators">Standalone Validators</a>
subsection for more details.</li>
</ul>
<p>A rule can be used to validate one or multiple attributes, and an attribute may be validated by one or multiple rules.
A rule may be applied in certain <a href="structure-models.html#scenarios">scenarios</a> only by specifying the <code>on</code> option.
If you do not specify an <code>on</code> option, it means the rule will be applied to all scenarios.</p>
<p>When the <code>validate()</code> method is called, it does the following steps to perform validation:</p>
<ol>
<li>Determine which attributes should be validated by getting the attribute list from <span class="broken-link">yii\base\Model::scenarios()</span>
using the current <span class="broken-link">yii\base\Model::scenario</span>. These attributes are called <em>active attributes</em>.</li>
<li>Determine which validation rules should be used by getting the rule list from <span class="broken-link">yii\base\Model::rules()</span>
using the current <span class="broken-link">yii\base\Model::scenario</span>. These rules are called <em>active rules</em>.</li>
<li>Use each active rule to validate each active attribute which is associated with the rule.
The validation rules are evaluated in the order they are listed.</li>
</ol>
<p>According to the above validation steps, an attribute will be validated if and only if it is
an active attribute declared in <code>scenarios()</code> and is associated with one or multiple active rules
declared in <code>rules()</code>.</p>
<blockquote class="note"><p><strong>Note: </strong>It is handy to give names to rules i.e.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> [
        <span class="hljs-comment">// ...</span>
        <span class="hljs-string">'password'</span> =&gt; [[<span class="hljs-string">'password'</span>], <span class="hljs-string">'string'</span>, <span class="hljs-string">'max'</span> =&gt; <span class="hljs-number">60</span>],
    ];
}
</code></pre>
<p>You can use it in a child model:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-variable">$rules</span> = <span class="hljs-keyword">parent</span>::rules();
    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$rules</span>[<span class="hljs-string">'password'</span>]);
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$rules</span>;
}
</code></pre>
</blockquote>
<h3>Customizing Error Messages  <span id="customizing-error-messages"></span><a href="#customizing-error-messages" class="hashlink">&para;</a></h3><p>Most validators have default error messages that will be added to the model being validated when its attributes
fail the validation. For example, the <span class="broken-link">yii\validators\RequiredValidator</span> validator will add
a message "Username cannot be blank." to a model when the <code>username</code> attribute fails the rule using this validator.</p>
<p>You can customize the error message of a rule by specifying the <code>message</code> property when declaring the rule,
like the following,</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> [
        [<span class="hljs-string">'username'</span>, <span class="hljs-string">'required'</span>, <span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'Please choose a username.'</span>],
    ];
}
</code></pre>
<p>Some validators may support additional error messages to more precisely describe different causes of
validation failures. For example, the <span class="broken-link">yii\validators\NumberValidator</span> validator supports
<span class="broken-link">yii\validators\NumberValidator::tooBig</span> and <span class="broken-link">yii\validators\NumberValidator::tooSmall</span>
to describe the validation failure when the value being validated is too big and too small, respectively.
You may configure these error messages like configuring other properties of validators in a validation rule.</p>
<h3>Validation Events  <span id="validation-events"></span><a href="#validation-events" class="hashlink">&para;</a></h3><p>When <span class="broken-link">yii\base\Model::validate()</span> is called, it will call two methods that you may override to customize
the validation process:</p>
<ul>
<li><span class="broken-link">yii\base\Model::beforeValidate()</span>: the default implementation will trigger a <span class="broken-link">yii\base\Model::EVENT_BEFORE_VALIDATE</span>
event. You may either override this method or respond to this event to do some preprocessing work
(e.g. normalizing data inputs) before the validation occurs. The method should return a boolean value indicating
whether the validation should proceed or not.</li>
<li><span class="broken-link">yii\base\Model::afterValidate()</span>: the default implementation will trigger a <span class="broken-link">yii\base\Model::EVENT_AFTER_VALIDATE</span>
event. You may either override this method or respond to this event to do some postprocessing work after
the validation is completed.</li>
</ul>
<h3>Conditional Validation  <span id="conditional-validation"></span><a href="#conditional-validation" class="hashlink">&para;</a></h3><p>To validate attributes only when certain conditions apply, e.g. the validation of one attribute depends
on the value of another attribute you can use the <span class="broken-link">yii\validators\Validator::when</span> property
to define such conditions. For example,</p>
<pre><code class="hljs php language-php">    [<span class="hljs-string">'state'</span>, <span class="hljs-string">'required'</span>, <span class="hljs-string">'when'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$model</span>)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$model</span>-&gt;country == <span class="hljs-string">'USA'</span>;
    }]
</code></pre>
<p>The <span class="broken-link">yii\validators\Validator::when</span> property takes a PHP callable with the following signature:</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@param</span> Model $model the model being validated
 * <span class="hljs-doctag">@param</span> string $attribute the attribute being validated
 * <span class="hljs-doctag">@return</span> bool whether the rule should be applied
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>)</span>
</span></code></pre>
<p>If you also need to support client-side conditional validation, you should configure
the <span class="broken-link">yii\validators\Validator::whenClient</span> property which takes a string representing a JavaScript
function whose return value determines whether to apply the rule or not. For example,</p>
<pre><code class="hljs php language-php">    [<span class="hljs-string">'state'</span>, <span class="hljs-string">'required'</span>, <span class="hljs-string">'when'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$model</span>)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$model</span>-&gt;country == <span class="hljs-string">'USA'</span>;
    }, <span class="hljs-string">'whenClient'</span> =&gt; <span class="hljs-string">"function (attribute, value) {
        return $('#country').val() == 'USA';
    }"</span>]
</code></pre>
<h3>Data Filtering  <span id="data-filtering"></span><a href="#data-filtering" class="hashlink">&para;</a></h3><p>User inputs often need to be filtered or preprocessed. For example, you may want to trim the spaces around the
<code>username</code> input. You may use validation rules to achieve this goal.</p>
<p>The following examples shows how to trim the spaces in the inputs and turn empty inputs into nulls by using
the <a href="tutorial-core-validators.html#trim">trim</a> and <a href="tutorial-core-validators.md#default">default</a> core validators:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    [[<span class="hljs-string">'username'</span>, <span class="hljs-string">'email'</span>], <span class="hljs-string">'trim'</span>],
    [[<span class="hljs-string">'username'</span>, <span class="hljs-string">'email'</span>], <span class="hljs-string">'default'</span>],
];
</code></pre>
<p>You may also use the more general <a href="tutorial-core-validators.html#filter">filter</a> validator to perform more complex
data filtering.</p>
<p>As you can see, these validation rules do not really validate the inputs. Instead, they will process the values
and save them back to the attributes being validated.</p>
<h3>Handling Empty Inputs  <span id="handling-empty-inputs"></span><a href="#handling-empty-inputs" class="hashlink">&para;</a></h3><p>When input data are submitted from HTML forms, you often need to assign some default values to the inputs
if they are empty. You can do so by using the <a href="tutorial-core-validators.html#default">default</a> validator. For example,</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// set "username" and "email" as null if they are empty</span>
    [[<span class="hljs-string">'username'</span>, <span class="hljs-string">'email'</span>], <span class="hljs-string">'default'</span>],

    <span class="hljs-comment">// set "level" to be 1 if it is empty</span>
    [<span class="hljs-string">'level'</span>, <span class="hljs-string">'default'</span>, <span class="hljs-string">'value'</span> =&gt; <span class="hljs-number">1</span>],
];
</code></pre>
<p>By default, an input is considered empty if its value is an empty string, an empty array or a <code>null</code>.
You may customize the default empty detection logic by configuring the <span class="broken-link">yii\validators\Validator::isEmpty</span> property
with a PHP callable. For example,</p>
<pre><code class="hljs php language-php">    [<span class="hljs-string">'agree'</span>, <span class="hljs-string">'required'</span>, <span class="hljs-string">'isEmpty'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$value</span>)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$value</span>);
    }]
</code></pre>
<blockquote class="note"><p><strong>Note: </strong>Most validators do not handle empty inputs if their <span class="broken-link">yii\validators\Validator::skipOnEmpty</span> property takes
  the default value <code>true</code>. They will simply be skipped during validation if their associated attributes receive empty
  inputs. Among the <a href="tutorial-core-validators.html">core validators</a>, only the <code>captcha</code>, <code>default</code>, <code>filter</code>,
  <code>required</code>, and <code>trim</code> validators will handle empty inputs.</p>
</blockquote>
<h2>Ad Hoc Validation  <span id="ad-hoc-validation"></span><a href="#ad-hoc-validation" class="hashlink">&para;</a></h2><p>Sometimes you need to do <em>ad hoc validation</em> for values that are not bound to any model.</p>
<p>If you only need to perform one type of validation (e.g. validating email addresses), you may call
the <span class="broken-link">yii\validators\Validator::validate()</span> method of the desired validator, like the following:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$email</span> = <span class="hljs-string">'test@example.com'</span>;
<span class="hljs-variable">$validator</span> = <span class="hljs-keyword">new</span> yii\validators\EmailValidator();

<span class="hljs-keyword">if</span> (<span class="hljs-variable">$validator</span>-&gt;validate(<span class="hljs-variable">$email</span>, <span class="hljs-variable">$error</span>)) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Email is valid.'</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$error</span>;
}
</code></pre>
<blockquote class="note"><p><strong>Note: </strong>Not all validators support this type of validation. An example is the <a href="tutorial-core-validators.html#unique">unique</a>
  core validator which is designed to work with a model only.</p>
</blockquote>
<p>If you need to perform multiple validations against several values, you can use <span class="broken-link">yii\base\DynamicModel</span>
which supports declaring both attributes and rules on the fly. Its usage is like the following:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionSearch</span><span class="hljs-params">(<span class="hljs-variable">$name</span>, <span class="hljs-variable">$email</span>)</span>
</span>{
    <span class="hljs-variable">$model</span> = DynamicModel::validateData(compact(<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>), [
        [[<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>], <span class="hljs-string">'string'</span>, <span class="hljs-string">'max'</span> =&gt; <span class="hljs-number">128</span>],
        [<span class="hljs-string">'email'</span>, <span class="hljs-string">'email'</span>],
    ]);

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$model</span>-&gt;hasErrors()) {
        <span class="hljs-comment">// validation fails</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// validation succeeds</span>
    }
}
</code></pre>
<p>The <span class="broken-link">yii\base\DynamicModel::validateData()</span> method creates an instance of <code>DynamicModel</code>, defines the attributes
using the given data (<code>name</code> and <code>email</code> in this example), and then calls <span class="broken-link">yii\base\Model::validate()</span>
with the given rules.</p>
<p>Alternatively, you may use the following more "classic" syntax to perform ad hoc data validation:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionSearch</span><span class="hljs-params">(<span class="hljs-variable">$name</span>, <span class="hljs-variable">$email</span>)</span>
</span>{
    <span class="hljs-variable">$model</span> = <span class="hljs-keyword">new</span> DynamicModel(compact(<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>));
    <span class="hljs-variable">$model</span>-&gt;addRule([<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>], <span class="hljs-string">'string'</span>, [<span class="hljs-string">'max'</span> =&gt; <span class="hljs-number">128</span>])
        -&gt;addRule(<span class="hljs-string">'email'</span>, <span class="hljs-string">'email'</span>)
        -&gt;validate();

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$model</span>-&gt;hasErrors()) {
        <span class="hljs-comment">// validation fails</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// validation succeeds</span>
    }
}
</code></pre>
<p>After validation, you can check if the validation succeeded or not by calling the
<span class="broken-link">yii\base\DynamicModel::hasErrors()</span> method, and then get the validation errors from the
<span class="broken-link">yii\base\DynamicModel::errors</span> property, like you do with a normal model.
You may also access the dynamic attributes defined through the model instance, e.g.,
<code>$model-&gt;name</code> and <code>$model-&gt;email</code>.</p>
<h2>Creating Validators  <span id="creating-validators"></span><a href="#creating-validators" class="hashlink">&para;</a></h2><p>Besides using the <a href="tutorial-core-validators.html">core validators</a> included in the Yii releases, you may also
create your own validators. You may create inline validators or standalone validators.</p>
<h3>Inline Validators  <span id="inline-validators"></span><a href="#inline-validators" class="hashlink">&para;</a></h3><p>An inline validator is one defined in terms of a model method or an anonymous function. The signature of
the method/function is:</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@param</span> string $attribute the attribute currently being validated
 * <span class="hljs-doctag">@param</span> mixed $params the value of the "params" given in the rule
 * <span class="hljs-doctag">@param</span> \yii\validators\InlineValidator related InlineValidator instance.
 * This parameter is available since version 2.0.11.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$params</span>, <span class="hljs-variable">$validator</span>)</span>
</span></code></pre>
<p>If an attribute fails the validation, the method/function should call <span class="broken-link">yii\base\Model::addError()</span> to save
the error message in the model so that it can be retrieved back later to present to end users.</p>
<p>Below are some examples:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Model</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyForm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$country</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-comment">// an inline validator defined as the model method validateCountry()</span>
            [<span class="hljs-string">'country'</span>, <span class="hljs-string">'validateCountry'</span>],

            <span class="hljs-comment">// an inline validator defined as an anonymous function</span>
            [<span class="hljs-string">'token'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$params</span>, <span class="hljs-variable">$validator</span>)</span> </span>{
                <span class="hljs-keyword">if</span> (!ctype_alnum(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-variable">$attribute</span>)) {
                    <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-variable">$attribute</span>, <span class="hljs-string">'The token must contain letters or digits.'</span>);
                }
            }],
        ];
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateCountry</span><span class="hljs-params">(<span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$params</span>, <span class="hljs-variable">$validator</span>)</span>
    </span>{
        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-variable">$attribute</span>, [<span class="hljs-string">'USA'</span>, <span class="hljs-string">'Web'</span>])) {
            <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-variable">$attribute</span>, <span class="hljs-string">'The country must be either "USA" or "Web".'</span>);
        }
    }
}
</code></pre>
<blockquote class="note"><p><strong>Note: </strong>Since version 2.0.11 you can use <span class="broken-link">yii\validators\InlineValidator::addError()</span> for adding errors instead. That way the error
message can be formatted using <span class="broken-link">yii\i18n\I18N::format()</span> right away. Use <code>{attribute}</code> and <code>{value}</code> in the error
message to refer to an attribute label (no need to get it manually) and attribute value accordingly:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$validator</span>-&gt;addError(<span class="hljs-variable">$this</span>, <span class="hljs-variable">$attribute</span>, <span class="hljs-string">'The value "{value}" is not acceptable for {attribute}.'</span>);
</code></pre>
</blockquote>
<blockquote class="note"><p><strong>Note: </strong>By default, inline validators will not be applied if their associated attributes receive empty inputs
  or if they have already failed some validation rules. If you want to make sure a rule is always applied,
  you may configure the <span class="broken-link">yii\validators\Validator::skipOnEmpty</span> and/or <span class="broken-link">yii\validators\Validator::skipOnError</span>
  properties to be <code>false</code> in the rule declarations. For example:</p>
<pre><code class="hljs php language-php">[
    [<span class="hljs-string">'country'</span>, <span class="hljs-string">'validateCountry'</span>, <span class="hljs-string">'skipOnEmpty'</span> =&gt; <span class="hljs-keyword">false</span>, <span class="hljs-string">'skipOnError'</span> =&gt; <span class="hljs-keyword">false</span>],
]
</code></pre>
</blockquote>
<h3>Standalone Validators  <span id="standalone-validators"></span><a href="#standalone-validators" class="hashlink">&para;</a></h3><p>A standalone validator is a class extending <span class="broken-link">yii\validators\Validator</span> or its child class. You may implement
its validation logic by overriding the <span class="broken-link">yii\validators\Validator::validateAttribute()</span> method. If an attribute
fails the validation, call <span class="broken-link">yii\base\Model::addError()</span> to save the error message in the model, like you do
with <a href="#inline-validators">inline validators</a>.</p>
<p>For example the inline validator above could be moved into new [[components/validators/CountryValidator]] class.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">validators</span>\<span class="hljs-title">Validator</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CountryValidator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Validator</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateAttribute</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>)</span>
    </span>{
        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$model</span>-&gt;<span class="hljs-variable">$attribute</span>, [<span class="hljs-string">'USA'</span>, <span class="hljs-string">'Web'</span>])) {
            <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>, <span class="hljs-string">'The country must be either "USA" or "Web".'</span>);
        }
    }
}
</code></pre>
<p>If you want your validator to support validating a value without a model, you should also override
<span class="broken-link">yii\validators\Validator::validate()</span>. You may also override <span class="broken-link">yii\validators\Validator::validateValue()</span>
instead of <code>validateAttribute()</code> and <code>validate()</code> because by default the latter two methods are implemented
by calling <code>validateValue()</code>.</p>
<p>Below is an example of how you could use the above validator class within your model.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">models</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Yii</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Model</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>\<span class="hljs-title">validators</span>\<span class="hljs-title">CountryValidator</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EntryForm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$email</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$country</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> [
            [[<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>], <span class="hljs-string">'required'</span>],
            [<span class="hljs-string">'country'</span>, CountryValidator::className()],
            [<span class="hljs-string">'email'</span>, <span class="hljs-string">'email'</span>],
        ];
    }
}
</code></pre>
<h2>Multiple Attributes Validation  <span id="multiple-attributes-validation"></span><a href="#multiple-attributes-validation" class="hashlink">&para;</a></h2><p>Sometimes validators involve multiple attributes. Consider the following form:</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MigrationForm</span> <span class="hljs-keyword">extends</span> \<span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Model</span>
</span>{
    <span class="hljs-comment">/**
     * Minimal funds amount for one adult person
     */</span>
    <span class="hljs-keyword">const</span> MIN_ADULT_FUNDS = <span class="hljs-number">3000</span>;
    <span class="hljs-comment">/**
     * Minimal funds amount for one child
     */</span>
    <span class="hljs-keyword">const</span> MIN_CHILD_FUNDS = <span class="hljs-number">1500</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$personalSalary</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$spouseSalary</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$childrenCount</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$description</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> [
            [[<span class="hljs-string">'personalSalary'</span>, <span class="hljs-string">'description'</span>], <span class="hljs-string">'required'</span>],
            [[<span class="hljs-string">'personalSalary'</span>, <span class="hljs-string">'spouseSalary'</span>], <span class="hljs-string">'integer'</span>, <span class="hljs-string">'min'</span> =&gt; <span class="hljs-keyword">self</span>::MIN_ADULT_FUNDS],
            [<span class="hljs-string">'childrenCount'</span>, <span class="hljs-string">'integer'</span>, <span class="hljs-string">'min'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'max'</span> =&gt; <span class="hljs-number">5</span>],
            [[<span class="hljs-string">'spouseSalary'</span>, <span class="hljs-string">'childrenCount'</span>], <span class="hljs-string">'default'</span>, <span class="hljs-string">'value'</span> =&gt; <span class="hljs-number">0</span>],
            [<span class="hljs-string">'description'</span>, <span class="hljs-string">'string'</span>],
        ];
    }
}
</code></pre>
<h3>Creating validator  <span id="multiple-attributes-validator"></span><a href="#multiple-attributes-validator" class="hashlink">&para;</a></h3><p>Let's say we need to check if the family income is enough for children. We can create inline validator
<code>validateChildrenFunds</code> for that which will run only when <code>childrenCount</code> is more than 0.</p>
<p>Note that we can't use all validated attributes (<code>['personalSalary', 'spouseSalary', 'childrenCount']</code>) when attaching
validator. This is because the same validator will run for each attribute (3 times in total) and we only need to run it
once for the whole attribute set.</p>
<p>You can use any of these attributes instead (or use what you think is the most relevant):</p>
<pre><code class="hljs php language-php">[<span class="hljs-string">'childrenCount'</span>, <span class="hljs-string">'validateChildrenFunds'</span>, <span class="hljs-string">'when'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$model</span>)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$model</span>-&gt;childrenCount &gt; <span class="hljs-number">0</span>;
}],
</code></pre>
<p>Implementation of <code>validateChildrenFunds</code> can be like this:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateChildrenFunds</span><span class="hljs-params">(<span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$params</span>)</span>
</span>{
    <span class="hljs-variable">$totalSalary</span> = <span class="hljs-variable">$this</span>-&gt;personalSalary + <span class="hljs-variable">$this</span>-&gt;spouseSalary;
    <span class="hljs-comment">// Double the minimal adult funds if spouse salary is specified</span>
    <span class="hljs-variable">$minAdultFunds</span> = <span class="hljs-variable">$this</span>-&gt;spouseSalary ? <span class="hljs-keyword">self</span>::MIN_ADULT_FUNDS * <span class="hljs-number">2</span> : <span class="hljs-keyword">self</span>::MIN_ADULT_FUNDS;
    <span class="hljs-variable">$childFunds</span> = <span class="hljs-variable">$totalSalary</span> - <span class="hljs-variable">$minAdultFunds</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$childFunds</span> / <span class="hljs-variable">$this</span>-&gt;childrenCount &lt; <span class="hljs-keyword">self</span>::MIN_CHILD_FUNDS) {
        <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'childrenCount'</span>, <span class="hljs-string">'Your salary is not enough for children.'</span>);
    }
}
</code></pre>
<p>You can ignore <code>$attribute</code> parameter because validation is not related to just one attribute.</p>
<h3>Adding errors  <span id="multiple-attributes-errors"></span><a href="#multiple-attributes-errors" class="hashlink">&para;</a></h3><p>Adding error in case of multiple attributes can vary depending on desired form design:</p>
<ul>
<li>Select the most relevant field in your opinion and add error to it's attribute:</li>
</ul>
<pre><code class="hljs php language-php"><span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'childrenCount'</span>, <span class="hljs-string">'Your salary is not enough for children.'</span>);
</code></pre>
<ul>
<li>Select multiple important relevant attributes or all attributes and add the same error message to them. We can store
message in separate variable before passing it to <code>addError</code> to keep code DRY.</li>
</ul>
<pre><code class="hljs php language-php"><span class="hljs-variable">$message</span> = <span class="hljs-string">'Your salary is not enough for children.'</span>;
<span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'personalSalary'</span>, <span class="hljs-variable">$message</span>);
<span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'wifeSalary'</span>, <span class="hljs-variable">$message</span>);
<span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'childrenCount'</span>, <span class="hljs-variable">$message</span>);
</code></pre>
<p>Or use a loop:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$attributes</span> = [<span class="hljs-string">'personalSalary, '</span>wifeSalary<span class="hljs-string">', '</span>childrenCount<span class="hljs-string">'];
foreach ($attributes as $attribute) {
    $this-&gt;addError($attribute, '</span>Your salary is not enough <span class="hljs-keyword">for</span> children.<span class="hljs-string">');
}
</span></code></pre>
<ul>
<li>Add a common error (not related to particular attribute). We can use the not existing attribute name for adding
error, for example <code>*</code>, because attribute existence is not checked at that point.</li>
</ul>
<pre><code class="hljs php language-php"><span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'*'</span>, <span class="hljs-string">'Your salary is not enough for children.'</span>);
</code></pre>
<p>As a result, we will not see error message near form fields. To display it, we can include the error summary in view:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?</span>= <span class="hljs-variable">$form</span>-&gt;errorSummary(<span class="hljs-variable">$model</span>) <span class="hljs-preprocessor">?&gt;</span>
</code></pre>
<h3>Custom validator  <span id="multiple-attributes-custom-validator"></span><a href="#multiple-attributes-custom-validator" class="hashlink">&para;</a></h3><p>If passing one attribute is not acceptable for you (for example it can be hard to choose which one is more relevant or
you consider it misleading in rules), the more advanced solution is to implement <code>CustomValidator</code> with support for
validating multiple attributes at once.</p>
<p>By default if multiple attributes are used for validation, the loop will be used to apply the same validation to each
of them. Let's use a separate trait and override <span class="broken-link">yii\base\Validator:validateAttributes()</span>:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">trait</span> BatchValidationTrait
{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> bool whether to validate multiple attributes at once
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$batch</span> = <span class="hljs-keyword">false</span>;

    <span class="hljs-comment">/**
     * Validates the specified object.
     * <span class="hljs-doctag">@param</span> \yii\base\Model $model the data model being validated.
     * <span class="hljs-doctag">@param</span> array|null $attributes the list of attributes to be validated.
     * Note that if an attribute is not associated with the validator, or is is prefixed with `!` char - it will be
     * ignored. If this parameter is null, every attribute listed in [[attributes]] will be validated.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateAttributes</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attributes</span> = null)</span>
    </span>{
        <span class="hljs-keyword">if</span> (is_array(<span class="hljs-variable">$attributes</span>)) {
            <span class="hljs-variable">$newAttributes</span> = [];
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$attributes</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$attribute</span>) {
                <span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$this</span>-&gt;attributes) || in_array(<span class="hljs-string">'!'</span> . <span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$this</span>-&gt;attributes)) {
                    <span class="hljs-variable">$newAttributes</span>[] = <span class="hljs-variable">$attribute</span>;
                }
            }
            <span class="hljs-variable">$attributes</span> = <span class="hljs-variable">$newAttributes</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable">$attributes</span> = [];
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$this</span>-&gt;attributes <span class="hljs-keyword">as</span> <span class="hljs-variable">$attribute</span>) {
                <span class="hljs-variable">$attributes</span>[] = <span class="hljs-variable">$attribute</span>[<span class="hljs-number">0</span>] === <span class="hljs-string">'!'</span> ? substr(<span class="hljs-variable">$attribute</span>, <span class="hljs-number">1</span>) : <span class="hljs-variable">$attribute</span>;
            }
        }

        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$attributes</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$attribute</span>) {
            <span class="hljs-variable">$skip</span> = <span class="hljs-variable">$this</span>-&gt;skipOnError &amp;&amp; <span class="hljs-variable">$model</span>-&gt;hasErrors(<span class="hljs-variable">$attribute</span>)
                || <span class="hljs-variable">$this</span>-&gt;skipOnEmpty &amp;&amp; <span class="hljs-variable">$this</span>-&gt;isEmpty(<span class="hljs-variable">$model</span>-&gt;<span class="hljs-variable">$attribute</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$skip</span>) {
                <span class="hljs-comment">// Skip validation if at least one attribute is empty or already has error</span>
                <span class="hljs-comment">// (according skipOnError and skipOnEmpty options must be set to true</span>
                <span class="hljs-keyword">return</span>;
            }
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$this</span>-&gt;batch) {
            <span class="hljs-comment">// Validate all attributes at once</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$this</span>-&gt;when === <span class="hljs-keyword">null</span> || call_user_func(<span class="hljs-variable">$this</span>-&gt;when, <span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>)) {
                <span class="hljs-comment">// Pass array with all attributes instead of one attribute</span>
                <span class="hljs-variable">$this</span>-&gt;validateAttribute(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attributes</span>);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// Validate each attribute separately using the same validation logic</span>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$attributes</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$attribute</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$this</span>-&gt;when === <span class="hljs-keyword">null</span> || call_user_func(<span class="hljs-variable">$this</span>-&gt;when, <span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>)) {
                    <span class="hljs-variable">$this</span>-&gt;validateAttribute(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>);
                }
            }
        }
    }
}
</code></pre>
<p>Then we need to create custom validator and use the created trait:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">validators</span>\<span class="hljs-title">Validator</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomValidator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Validator</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">BatchValidationTrait</span>;
}
</code></pre>
<p>To support inline validation as well we can extend default inline validator and also use this trait:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">validators</span>\<span class="hljs-title">InlineValidator</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomInlineValidator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">InlineValidator</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">BatchValidationTrait</span>;
}
</code></pre>
<p>Couple more changes are needed.</p>
<p>First to use our <code>CustomInlineValidator</code> instead of default <code>InlineValidator</code> we need to override
<span class="broken-link">\yii\validators\Validator::createValidator()</span> method in <code>CustomValidator</code>:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createValidator</span><span class="hljs-params">(<span class="hljs-variable">$type</span>, <span class="hljs-variable">$model</span>, <span class="hljs-variable">$attributes</span>, <span class="hljs-variable">$params</span> = [])</span>
</span>{
    <span class="hljs-variable">$params</span>[<span class="hljs-string">'attributes'</span>] = <span class="hljs-variable">$attributes</span>;

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$type</span> <span class="hljs-keyword">instanceof</span> \Closure || <span class="hljs-variable">$model</span>-&gt;hasMethod(<span class="hljs-variable">$type</span>)) {
        <span class="hljs-comment">// method-based validator</span>
        <span class="hljs-comment">// The following line is changed to use our CustomInlineValidator</span>
        <span class="hljs-variable">$params</span>[<span class="hljs-string">'class'</span>] = <span class="hljs-keyword">__NAMESPACE__</span> . <span class="hljs-string">'\CustomInlineValidator'</span>;
        <span class="hljs-variable">$params</span>[<span class="hljs-string">'method'</span>] = <span class="hljs-variable">$type</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">static</span>::<span class="hljs-variable">$builtInValidators</span>[<span class="hljs-variable">$type</span>])) {
            <span class="hljs-variable">$type</span> = <span class="hljs-keyword">static</span>::<span class="hljs-variable">$builtInValidators</span>[<span class="hljs-variable">$type</span>];
        }
        <span class="hljs-keyword">if</span> (is_array(<span class="hljs-variable">$type</span>)) {
            <span class="hljs-variable">$params</span> = array_merge(<span class="hljs-variable">$type</span>, <span class="hljs-variable">$params</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable">$params</span>[<span class="hljs-string">'class'</span>] = <span class="hljs-variable">$type</span>;
        }
    }

    <span class="hljs-keyword">return</span> Yii::createObject(<span class="hljs-variable">$params</span>);
}
</code></pre>
<p>And finally to support our custom validator in model we can create the trait and override
<span class="broken-link">\yii\base\Model::createValidators()</span> like this:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">InvalidConfigException</span>;

<span class="hljs-keyword">trait</span> CustomValidationTrait
{
    <span class="hljs-comment">/**
     * Creates validator objects based on the validation rules specified in [[rules()]].
     * Unlike [[getValidators()]], each time this method is called, a new list of validators will be returned.
     * <span class="hljs-doctag">@return</span> ArrayObject validators
     * <span class="hljs-doctag">@throws</span> InvalidConfigException if any validation rule configuration is invalid
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createValidators</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-variable">$validators</span> = <span class="hljs-keyword">new</span> ArrayObject;
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$this</span>-&gt;rules() <span class="hljs-keyword">as</span> <span class="hljs-variable">$rule</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$rule</span> <span class="hljs-keyword">instanceof</span> Validator) {
                <span class="hljs-variable">$validators</span>-&gt;append(<span class="hljs-variable">$rule</span>);
            } <span class="hljs-keyword">elseif</span> (is_array(<span class="hljs-variable">$rule</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$rule</span>[<span class="hljs-number">0</span>], <span class="hljs-variable">$rule</span>[<span class="hljs-number">1</span>])) { <span class="hljs-comment">// attributes, validator type</span>
                <span class="hljs-comment">// The following line is changed in order to use our CustomValidator</span>
                <span class="hljs-variable">$validator</span> = CustomValidator::createValidator(<span class="hljs-variable">$rule</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$this</span>, (<span class="hljs-keyword">array</span>) <span class="hljs-variable">$rule</span>[<span class="hljs-number">0</span>], array_slice(<span class="hljs-variable">$rule</span>, <span class="hljs-number">2</span>));
                <span class="hljs-variable">$validators</span>-&gt;append(<span class="hljs-variable">$validator</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidConfigException(<span class="hljs-string">'Invalid validation rule: a rule must specify both attribute names and validator type.'</span>);
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$validators</span>;
    }
}
</code></pre>
<p>Now we can implement custom validator by extending from <code>CustomValidator</code>:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">validators</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>\<span class="hljs-title">CustomValidator</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChildrenFundsValidator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CustomValidator</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateAttribute</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>)</span>
    </span>{
        <span class="hljs-comment">// $attribute here is not a single attribute, it's an array containing all related attributes</span>
        <span class="hljs-variable">$totalSalary</span> = <span class="hljs-variable">$this</span>-&gt;personalSalary + <span class="hljs-variable">$this</span>-&gt;spouseSalary;
        <span class="hljs-comment">// Double the minimal adult funds if spouse salary is specified</span>
        <span class="hljs-variable">$minAdultFunds</span> = <span class="hljs-variable">$this</span>-&gt;spouseSalary ? <span class="hljs-keyword">self</span>::MIN_ADULT_FUNDS * <span class="hljs-number">2</span> : <span class="hljs-keyword">self</span>::MIN_ADULT_FUNDS;
        <span class="hljs-variable">$childFunds</span> = <span class="hljs-variable">$totalSalary</span> - <span class="hljs-variable">$minAdultFunds</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$childFunds</span> / <span class="hljs-variable">$this</span>-&gt;childrenCount &lt; <span class="hljs-keyword">self</span>::MIN_CHILD_FUNDS) {
            <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'*'</span>, <span class="hljs-string">'Your salary is not enough for children.'</span>);
        }
    }
}
</code></pre>
<p>Because <code>$attribute</code> contains the list of all related attributes, we can use loop in case of adding errors for all
attributes is needed:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$attribute</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$singleAttribute</span>) {
    <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-variable">$attribute</span>, <span class="hljs-string">'Your salary is not enough for children.'</span>);
}
</code></pre>
<p>Now it's possible to specify all related attributes in according validation rule:</p>
<pre><code class="hljs php language-php">[
    [<span class="hljs-string">'personalSalary'</span>, <span class="hljs-string">'spouseSalary'</span>, <span class="hljs-string">'childrenCount'</span>],
    \app\validators\ChildrenFundsValidator::className(),
    <span class="hljs-string">'batch'</span> =&gt; `<span class="hljs-keyword">true</span>`,
    <span class="hljs-string">'when'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$model</span>)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$model</span>-&gt;childrenCount &gt; <span class="hljs-number">0</span>;
    }
],
</code></pre>
<p>For inline validation the rule will be:</p>
<pre><code class="hljs php language-php">[
    [<span class="hljs-string">'personalSalary'</span>, <span class="hljs-string">'spouseSalary'</span>, <span class="hljs-string">'childrenCount'</span>],
    <span class="hljs-string">'validateChildrenFunds'</span>,
    <span class="hljs-string">'batch'</span> =&gt; `<span class="hljs-keyword">true</span>`,
    <span class="hljs-string">'when'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$model</span>)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$model</span>-&gt;childrenCount &gt; <span class="hljs-number">0</span>;
    }
],
</code></pre>
<p>And here is according validation method:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateChildrenFunds</span><span class="hljs-params">(<span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$params</span>)</span>
</span>{
    <span class="hljs-comment">// $attribute here is not a single attribute, it's an array containing all related attributes</span>
    <span class="hljs-variable">$totalSalary</span> = <span class="hljs-variable">$this</span>-&gt;personalSalary + <span class="hljs-variable">$this</span>-&gt;spouseSalary;
    <span class="hljs-comment">// Double the minimal adult funds if spouse salary is specified</span>
    <span class="hljs-variable">$minAdultFunds</span> = <span class="hljs-variable">$this</span>-&gt;spouseSalary ? <span class="hljs-keyword">self</span>::MIN_ADULT_FUNDS * <span class="hljs-number">2</span> : <span class="hljs-keyword">self</span>::MIN_ADULT_FUNDS;
    <span class="hljs-variable">$childFunds</span> = <span class="hljs-variable">$totalSalary</span> - <span class="hljs-variable">$minAdultFunds</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$childFunds</span> / <span class="hljs-variable">$this</span>-&gt;childrenCount &lt; <span class="hljs-keyword">self</span>::MIN_CHILD_FUNDS) {
        <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'childrenCount'</span>, <span class="hljs-string">'Your salary is not enough for children.'</span>);
    }
}
</code></pre>
<p>The advantages of this approach:</p>
<ul>
<li>It better reflects all attributes that participate in validation (the rules become more readable);</li>
<li>It respects the options <span class="broken-link">yii\validators\Validator::skipOnError</span> and <span class="broken-link">yii\validators\Validator::skipOnEmpty</span> for
<strong>each</strong> used attribute (not only for that you decided to choose as more relevant).</li>
</ul>
<p>If you have problems with implementing client validation, you can:</p>
<ul>
<li>combine <span class="broken-link">yii\widgets\ActiveForm::enableAjaxValidation</span> and
<span class="broken-link">yii\widgets\ActiveForm::enableAjaxValidation</span> options, so multiple attributes will be validated
with AJAX without page reload;</li>
<li>implement validation outside of <span class="broken-link">yii\validators\Validator::clientValidateAttribute</span> because it's designed to work
with single attribute.</li>
</ul>
<h2>Client-Side Validation  <span id="client-side-validation"></span><a href="#client-side-validation" class="hashlink">&para;</a></h2><p>Client-side validation based on JavaScript is desirable when end users provide inputs via HTML forms, because
it allows users to find out input errors faster and thus provides a better user experience. You may use or implement
a validator that supports client-side validation <em>in addition to</em> server-side validation.</p>
<blockquote class="info"><p><strong>Info: </strong>While client-side validation is desirable, it is not a must. Its main purpose is to provide users with a better
  experience. Similar to input data coming from end users, you should never trust client-side validation. For this reason,
  you should always perform server-side validation by calling <span class="broken-link">yii\base\Model::validate()</span>, as
  described in the previous subsections.</p>
</blockquote>
<h3>Using Client-Side Validation  <span id="using-client-side-validation"></span><a href="#using-client-side-validation" class="hashlink">&para;</a></h3><p>Many <a href="tutorial-core-validators.html">core validators</a> support client-side validation out-of-the-box. All you need to do
is just use <span class="broken-link">yii\widgets\ActiveForm</span> to build your HTML forms. For example, <code>LoginForm</code> below declares two
rules: one uses the <a href="tutorial-core-validators.html#required">required</a> core validator which is supported on both
client and server-sides; the other uses the <code>validatePassword</code> inline validator which is only supported on the server
side.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">models</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Model</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">models</span>\<span class="hljs-title">User</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginForm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-comment">// username and password are both required</span>
            [[<span class="hljs-string">'username'</span>, <span class="hljs-string">'password'</span>], <span class="hljs-string">'required'</span>],

            <span class="hljs-comment">// password is validated by validatePassword()</span>
            [<span class="hljs-string">'password'</span>, <span class="hljs-string">'validatePassword'</span>],
        ];
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validatePassword</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-variable">$user</span> = User::findByUsername(<span class="hljs-variable">$this</span>-&gt;username);

        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$user</span> || !<span class="hljs-variable">$user</span>-&gt;validatePassword(<span class="hljs-variable">$this</span>-&gt;password)) {
            <span class="hljs-variable">$this</span>-&gt;addError(<span class="hljs-string">'password'</span>, <span class="hljs-string">'Incorrect username or password.'</span>);
        }
    }
}
</code></pre>
<p>The HTML form built by the following code contains two input fields <code>username</code> and <code>password</code>.
If you submit the form without entering anything, you will find the error messages requiring you
to enter something appear right away without any communication with the server.</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span> <span class="hljs-variable">$form</span> = yii\widgets\ActiveForm::begin(); <span class="hljs-preprocessor">?&gt;</span>
    <span class="hljs-preprocessor">&lt;?</span>= <span class="hljs-variable">$form</span>-&gt;field(<span class="hljs-variable">$model</span>, <span class="hljs-string">'username'</span>) <span class="hljs-preprocessor">?&gt;</span>
    <span class="hljs-preprocessor">&lt;?</span>= <span class="hljs-variable">$form</span>-&gt;field(<span class="hljs-variable">$model</span>, <span class="hljs-string">'password'</span>)-&gt;passwordInput() <span class="hljs-preprocessor">?&gt;</span>
    <span class="hljs-preprocessor">&lt;?</span>= Html::submitButton(<span class="hljs-string">'Login'</span>) <span class="hljs-preprocessor">?&gt;</span>
<span class="hljs-preprocessor">&lt;?php</span> yii\widgets\ActiveForm::end(); <span class="hljs-preprocessor">?&gt;</span>
</code></pre>
<p>Behind the scene, <span class="broken-link">yii\widgets\ActiveForm</span> will read the validation rules declared in the model
and generate appropriate JavaScript code for validators that support client-side validation. When a user
changes the value of an input field or submit the form, the client-side validation JavaScript will be triggered.</p>
<p>If you want to turn off client-side validation completely, you may configure the
<span class="broken-link">yii\widgets\ActiveForm::enableClientValidation</span> property to be <code>false</code>. You may also turn off client-side
validation of individual input fields by configuring their <span class="broken-link">yii\widgets\ActiveField::enableClientValidation</span>
property to be false. When <code>enableClientValidation</code> is configured at both the input field level and the form level,
the former will take precedence.</p>
<blockquote class="info"><p><strong>Info: </strong>Since version 2.0.11 all validators extending from <span class="broken-link">yii\validators\Validator</span> receive client-side options
from separate method - <span class="broken-link">yii\validators\Validator::getClientOptions()</span>. You can use it:</p>
<ul>
<li>if you want to implement your own custom client-side validation but leave the synchronization with server-side
validator options;</li>
<li>to extend or customize to fit your specific needs:</li>
</ul>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getClientOptions</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>)</span>
</span>{
    <span class="hljs-variable">$options</span> = <span class="hljs-keyword">parent</span>::getClientOptions(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>);
    <span class="hljs-comment">// Modify $options here</span>

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$options</span>;
}
</code></pre>
</blockquote>
<h3>Implementing Client-Side Validation  <span id="implementing-client-side-validation"></span><a href="#implementing-client-side-validation" class="hashlink">&para;</a></h3><p>To create a validator that supports client-side validation, you should implement the
<span class="broken-link">yii\validators\Validator::clientValidateAttribute()</span> method which returns a piece of JavaScript code
that performs the validation on the client-side. Within the JavaScript code, you may use the following
predefined variables:</p>
<ul>
<li><code>attribute</code>: the name of the attribute being validated.</li>
<li><code>value</code>: the value being validated.</li>
<li><code>messages</code>: an array used to hold the validation error messages for the attribute.</li>
<li><code>deferred</code>: an array which deferred objects can be pushed into (explained in the next subsection).</li>
</ul>
<p>In the following example, we create a <code>StatusValidator</code> which validates if an input is a valid status input
against the existing status data. The validator supports both server-side and client-side validation.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">validators</span>\<span class="hljs-title">Validator</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">models</span>\<span class="hljs-title">Status</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StatusValidator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Validator</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">parent</span>::init();
        <span class="hljs-variable">$this</span>-&gt;message = <span class="hljs-string">'Invalid status input.'</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateAttribute</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>)</span>
    </span>{
        <span class="hljs-variable">$value</span> = <span class="hljs-variable">$model</span>-&gt;<span class="hljs-variable">$attribute</span>;
        <span class="hljs-keyword">if</span> (!Status::find()-&gt;where([<span class="hljs-string">'id'</span> =&gt; <span class="hljs-variable">$value</span>])-&gt;exists()) {
            <span class="hljs-variable">$model</span>-&gt;addError(<span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$this</span>-&gt;message);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clientValidateAttribute</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$view</span>)</span>
    </span>{
        <span class="hljs-variable">$statuses</span> = json_encode(Status::find()-&gt;select(<span class="hljs-string">'id'</span>)-&gt;asArray()-&gt;column());
        <span class="hljs-variable">$message</span> = json_encode(<span class="hljs-variable">$this</span>-&gt;message, JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE);
        <span class="hljs-keyword">return</span> <span class="hljs-string">&lt;&lt;&lt;JS
if ($.inArray(value, <span class="hljs-subst">$statuses</span>) === -1) {
    messages.push(<span class="hljs-subst">$message</span>);
}
JS;</span>
    }
}
</code></pre>
<blockquote class="tip"><p><strong>Tip: </strong>The above code is given mainly to demonstrate how to support client-side validation. In practice,
you may use the <a href="tutorial-core-validators.html#in">in</a> core validator to achieve the same goal. You may
write the validation rule like the following:</p>
<pre><code class="hljs php language-php">[
    [<span class="hljs-string">'status'</span>, <span class="hljs-string">'in'</span>, <span class="hljs-string">'range'</span> =&gt; Status::find()-&gt;select(<span class="hljs-string">'id'</span>)-&gt;asArray()-&gt;column()],
]
</code></pre>
</blockquote>
<blockquote class="tip"><p><strong>Tip: </strong>If you need to work with client validation manually i.e. dynamically add fields or do some custom UI logic, refer
to <a href="https://github.com/samdark/yii2-cookbook/blob/master/book/forms-activeform-js.md">Working with ActiveForm via JavaScript</a>
in Yii 2.0 Cookbook.</p>
</blockquote>
<h3>Deferred Validation  <span id="deferred-validation"></span><a href="#deferred-validation" class="hashlink">&para;</a></h3><p>If you need to perform asynchronous client-side validation, you can create <a href="http://api.jquery.com/category/deferred-object/">Deferred objects</a>.
For example, to perform a custom AJAX validation, you can use the following code:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clientValidateAttribute</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$view</span>)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&lt;&lt;&lt;JS
        deferred.push($.get("/check", {value: value}).done(function(data) {
            if ('' !== data) {
                messages.push(data);
            }
        }));
JS;</span>
}
</code></pre>
<p>In the above, the <code>deferred</code> variable is provided by Yii, which is an array of Deferred objects. The <code>$.get()</code>
jQuery method creates a Deferred object which is pushed to the <code>deferred</code> array.</p>
<p>You can also explicitly create a Deferred object and call its <code>resolve()</code> method when the asynchronous callback
is hit. The following example shows how to validate the dimensions of an uploaded image file on the client-side.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clientValidateAttribute</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$view</span>)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&lt;&lt;&lt;JS
        var def = $.Deferred();
        var img = new Image();
        img.onload = function() {
            if (this.width &gt; 150) {
                messages.push('Image too wide!!');
            }
            def.resolve();
        }
        var reader = new FileReader();
        reader.onloadend = function() {
            img.src = reader.result;
        }
        reader.readAsDataURL(file);

        deferred.push(def);
JS;</span>
}
</code></pre>
<blockquote class="note"><p><strong>Note: </strong>The <code>resolve()</code> method must be called after the attribute has been validated. Otherwise the main form
  validation will not complete.</p>
</blockquote>
<p>For simplicity, the <code>deferred</code> array is equipped with a shortcut method <code>add()</code> which automatically creates a Deferred
object and adds it to the <code>deferred</code> array. Using this method, you can simplify the above example as follows,</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clientValidateAttribute</span><span class="hljs-params">(<span class="hljs-variable">$model</span>, <span class="hljs-variable">$attribute</span>, <span class="hljs-variable">$view</span>)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&lt;&lt;&lt;JS
        deferred.add(function(def) {
            var img = new Image();
            img.onload = function() {
                if (this.width &gt; 150) {
                    messages.push('Image too wide!!');
                }
                def.resolve();
            }
            var reader = new FileReader();
            reader.onloadend = function() {
                img.src = reader.result;
            }
            reader.readAsDataURL(file);
        });
JS;</span>
}
</code></pre>
<h3>AJAX Validation  <span id="ajax-validation"></span><a href="#ajax-validation" class="hashlink">&para;</a></h3><p>Some validations can only be done on the server-side, because only the server has the necessary information.
For example, to validate if a username is unique or not, it is necessary to check the user table on the server-side.
You can use AJAX-based validation in this case. It will trigger an AJAX request in the background to validate the
input while keeping the same user experience as the regular client-side validation.</p>
<p>To enable AJAX validation for a single input field, configure the <span class="broken-link">yii\widgets\ActiveField::enableAjaxValidation</span>
property of that field to be <code>true</code> and specify a unique form <code>id</code>:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">widgets</span>\<span class="hljs-title">ActiveForm</span>;

<span class="hljs-variable">$form</span> = ActiveForm::begin([
    <span class="hljs-string">'id'</span> =&gt; <span class="hljs-string">'registration-form'</span>,
]);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$form</span>-&gt;field(<span class="hljs-variable">$model</span>, <span class="hljs-string">'username'</span>, [<span class="hljs-string">'enableAjaxValidation'</span> =&gt; <span class="hljs-keyword">true</span>]);

<span class="hljs-comment">// ...</span>

ActiveForm::end();
</code></pre>
<p>To enable AJAX validation for the whole form, configure <span class="broken-link">yii\widgets\ActiveForm::enableAjaxValidation</span>
to be <code>true</code> at the form level:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$form</span> = ActiveForm::begin([
    <span class="hljs-string">'id'</span> =&gt; <span class="hljs-string">'contact-form'</span>,
    <span class="hljs-string">'enableAjaxValidation'</span> =&gt; <span class="hljs-keyword">true</span>,
]);
</code></pre>
<blockquote class="note"><p><strong>Note: </strong>When the <code>enableAjaxValidation</code> property is configured at both the input field level and the form level,
  the former will take precedence.</p>
</blockquote>
<p>You also need to prepare the server so that it can handle the AJAX validation requests.
This can be achieved by a code snippet like the following in the controller actions:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">if</span> (Yii::<span class="hljs-variable">$app</span>-&gt;request-&gt;isAjax &amp;&amp; <span class="hljs-variable">$model</span>-&gt;load(Yii::<span class="hljs-variable">$app</span>-&gt;request-&gt;post())) {
    Yii::<span class="hljs-variable">$app</span>-&gt;response-&gt;format = Response::FORMAT_JSON;
    <span class="hljs-keyword">return</span> ActiveForm::validate(<span class="hljs-variable">$model</span>);
}
</code></pre>
<p>The above code will check whether the current request is an AJAX. If yes, it will respond to
this request by running the validation and returning the errors in JSON format.</p>
<blockquote class="info"><p><strong>Info: </strong>You can also use <a href="#deferred-validation">Deferred Validation</a> to perform AJAX validation.
  However, the AJAX validation feature described here is more systematic and requires less coding effort.</p>
</blockquote>
<p>When both <code>enableClientValidation</code> and <code>enableAjaxValidation</code> are set to <code>true</code>, AJAX validation request will be triggered
only after the successful client validation.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Tue, 27 Dec 2016 23:01:01 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
